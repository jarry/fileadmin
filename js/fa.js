var Youngli=Youngli||{version:"1-0-1",date:"2010-7-10"};Youngli.guid="$YOUNGLI$";Youngli.string=Youngli.string||{};Youngli.string.trim=function(a){return String(a).replace(new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+\x24)","g"),"")};Youngli.string.toCamelCase=function(a){return String(a).replace(/[-_]\D/g,function(c){return c.charAt(1).toUpperCase()})};Youngli.string.getCharLength=function(h){if(!h||h.length<=0){return h}var f=0;var d=0;var a=h.length;var j;while(a>0){var j=h.charCodeAt(a);if(j>0&&j<128){f++}else{d+=2}a--}return f+d};var toCameCase=Youngli.string.toCamelCase;var trim=Youngli.string.trim;var string=Youngli.string;Youngli.browser=Youngli.browser||{};if(/chrome\/(\d+\.\d)/i.test(navigator.userAgent)){Youngli.browser.chrome=parseFloat(RegExp["\x241"])}if(/firefox\/(\d+\.\d)/i.test(navigator.userAgent)){Youngli.browser.firefox=parseFloat(RegExp["\x241"])}if(/msie (\d+\.\d)/i.test(navigator.userAgent)){ie=Youngli.browser.ie=parseFloat(RegExp["\x241"])}Youngli.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);Youngli.browser.isStrict=document.compatMode=="CSS1Compat";Youngli.browser.isWebkit=/webkit/i.test(navigator.userAgent);try{if(/(\d+\.\d)/.test(external.max_version)){Youngli.browser.maxthon=parseFloat(RegExp["\x241"])}}catch(e){}if(/opera\/(\d+\.\d)/i.test(navigator.userAgent)){Youngli.browser.opera=parseFloat(RegExp["\x241"])}if((/(\d+\.\d)(\.\d)?\s+safari/i.test(navigator.userAgent)&&!/chrome/i.test(navigator.userAgent))){Youngli.browser.safari=parseFloat(RegExp["\x241"])}var browser=Youngli.browser||{};Youngli.dom=Youngli.dom||{};Youngli.dom.g=function(a){if("string"==typeof a||a instanceof String){return document.getElementById(a)}else{if(a&&a.nodeName&&(a.nodeType==1||a.nodeType==9)){return a}}return null};var g=Youngli.dom.g;Youngli.dom.addClass=function(d,f){d=g(d);var c=trim(f).split(/\s+/),a=c.length;f=d.className.split(/\s+/).join(" ");while(a--){(new RegExp("(^| )"+c[a]+"( |\x24)")).test(f)&&c.splice(a,1)}d.className=trim(f+" "+c.join(" "));return d};Youngli.dom.children=function(c){c=g(c);for(var a=[],d=c.firstChild;d;d=d.nextSibling){if(d.nodeType==1){a.push(d)}}return a};Youngli.dom.getDocument=function(a){a=Youngli.dom.g(a);return a.nodeType==9?a:a.ownerDocument||a.document};Youngli.dom.getPosition=function(d){var k=Youngli.dom.getDocument(d);d=Youngli.dom.g(d);var j=browser.isGecko>0&&k.getBoxObjectFor&&Youngli.dom.getStyle(d,"position")=="absolute"&&(d.style.top===""||d.style.left==="");var l={left:0,top:0};var c=(browser.ie&&!browser.isStrict)?k.body:k.documentElement;if(d==c){return l}var f=null;var h;if(d.getBoundingClientRect){h=d.getBoundingClientRect();l.left=Math.floor(h.left)+Math.max(k.documentElement.scrollLeft,k.body.scrollLeft);l.top=Math.floor(h.top)+Math.max(k.documentElement.scrollTop,k.body.scrollTop);l.left-=k.documentElement.clientLeft;l.top-=k.documentElement.clientTop;if(browser.ie&&!browser.isStrict){l.left-=2;l.top-=2}}else{if(k.getBoxObjectFor&&!j){h=k.getBoxObjectFor(d);var a=k.getBoxObjectFor(c);l.left=h.screenX-a.screenX;l.top=h.screenY-a.screenY}else{f=d;do{l.left+=f.offsetLeft;l.top+=f.offsetTop;if(browser.isWebkit>0&&Youngli.dom.getStyle(f,"position")=="fixed"){l.left+=k.body.scrollLeft;l.top+=k.body.scrollTop;break}f=f.offsetParent}while(f&&f!=d);if(browser.opera>0||(browser.isWebkit>0&&Youngli.dom.getStyle(d,"position")=="absolute")){l.top-=k.body.offsetTop}f=d.offsetParent;while(f&&f!=k.body){l.left-=f.scrollLeft;if(!b.opera||f.tagName!="TR"){l.top-=f.scrollTop}f=f.offsetParent}}}return l};Youngli.dom._styleFilter=Youngli.dom._styleFilter||[];Youngli.dom._styleFilter[Youngli.dom._styleFilter.length]={set:function(a,c){if(c.constructor==Number&&!/zIndex|fontWeight|opacity|zoom|lineHeight/i.test(a)){c=c+"px"}return c}};Youngli.dom._styleFixer=Youngli.dom._styleFixer||{};Youngli.dom._styleFixer.display=browser.ie&&browser.ie<7?{set:function(a,c){a=a.style;if(c=="inline-block"){a.display="inline";a.zoom=1}else{a.display=c}}}:browser.firefox&&browser.firefox<3?{set:function(a,c){a.style.display=c=="inline-block"?"-moz-inline-box":c}}:null;Youngli.dom._styleFixer["float"]=browser.ie?"styleFloat":"cssFloat";Youngli.dom._styleFixer.opacity=browser.ie?{get:function(a){var c=a.style.filter;c&&c.indexOf("opacity=")>=0?(parseFloat(c.match(/opacity=([^)]*)/)[1])/100)+"":"1"},set:function(a,d){var c=a.style;c.filter=(c.filter||"").replace(/alpha\([^\)]*\)/gi,"")+(d==1?"":"alpha(opacity="+d*100+")");c.zoom=1}}:null;Youngli.dom._styleFixer.textOverflow=(function(){var c={};function a(h){var j=h.length;if(j>0){j=h[j-1];h.length--}else{j=null}return j}function d(h,j){h[browser.firefox?"textContent":"innerText"]=j}function f(r,l,v){var n=browser.ie?r.currentStyle||r.style:getComputedStyle(r,null),u=n.fontWeight,t="font-family:"+n.fontFamily+";font-size:"+n.fontSize+";word-spacing:"+n.wordSpacing+";font-weight:"+((parseInt(u)||0)==401?700:u)+";font-style:"+n.fontStyle+";font-variant:"+n.fontVariant,h=c[t];if(!h){n=r.appendChild(document.createElement("div"));n.style.cssText="float:left;"+t;h=c[t]=[];for(q=0;q<256;q++){q==32?(n.innerHTML="&nbsp;"):d(n,String.fromCharCode(q));h[q]=n.offsetWidth}d(n,"一");h[256]=n.offsetWidth;d(n,"一一");h[257]=n.offsetWidth-h[256]*2;h[258]=h[".".charCodeAt(0)]*3+h[257]*3;r.removeChild(n)}for(var p=r.firstChild,s=h[256],k=h[257],j=h[258],x=[],v=v?j:0;p;p=p.nextSibling){if(l<v){r.removeChild(p)}else{if(p.nodeType==3){for(var q=0,w=p.nodeValue,m=w.length;q<m;q++){n=w.charCodeAt(q);x[x.length]=[l,p,q];l-=(q?k:0)+(n<256?h[n]:s);if(l<v){break}}}else{n=p.tagName;if(n=="IMG"||n=="TABLE"){n=p;p=p.previousSibling;r.removeChild(n)}else{x[x.length]=[l,p];l-=p.offsetWidth}}}}if(l<v){while(n=a(x)){l=n[0];p=n[1];n=n[2];if(p.nodeType==3){if(l>=j){p.nodeValue=p.nodeValue.substring(0,n)+"...";return true}else{if(!n){r.removeChild(p)}}}else{if(f(p,l,true)){return true}else{r.removeChild(p)}}}r.innerHTML=""}}return{get:function(j,k){var h=h;return(h.opera?k.OTextOverflow:h.firefox?j._Overflow:k.textOverflow)||"clip"},set:function(j,l){var h=h;if(j.tagName=="TD"||j.tagName=="TH"||h.firefox){j._HTML&&(j.innerHTML=j._HTML);if(l=="ellipsis"){j._HTML=j.innerHTML;var m=document.createElement("div"),k=j.appendChild(m).offsetWidth;j.removeChild(m);f(j,k)}else{j._HTML=""}}m=j.style;h.opera?(m.OTextOverflow=l):h.firefox?(j._Overflow=l):(m.textOverflow=l)}}})();Youngli.dom._styleFilter.filter=function(c,h,j){for(var a=0,f=Youngli.dom._styleFilter,d;d=f[a];a++){if(d=d[j]){h=d(c,h)}}return h};Youngli.dom.getStyle=function(d,c){var j=Youngli.dom;d=j.g(d);c=Youngli.string.toCamelCase(c);var h=d.style[c];if(!h){var a=j._styleFixer[c],f=d.currentStyle||(browser.ie?d.style:getComputedStyle(d,null));if("string"==typeof a){h=f[a]}else{if(a&&a.get){h=a.get(d,f)}else{h=f[c]}}}if(a=j._styleFilter){h=a.filter(c,h,"get")}return h};Youngli.dom.remove=function(a){a=Youngli.dom.g(a);if("HTML BODY HEAD".indexOf(a.nodeName)==-1){if(browser.ie){var c=document.createElement("DIV");c.appendChild(a);c.innerHTML=""}else{(c=a.parentNode)&&c.removeChild(a)}}};Youngli.dom.removeClass=function(c,d){c=Youngli.dom.g(c);var a=string.trim;c.className=a(c.className.split(/\s+/).join("  ").replace(new RegExp("(^| )("+a(d).split(/\s+/).join("|")+")( |\x24)","g")," ").replace(/\s+/g," "));return c};Youngli.dom.setStyle=function(d,c,f){var h=Youngli.dom;var a;d=h.g(d);c=string.toCamelCase(c);if(a=h._styleFilter){f=a.filter(c,f,"set")}a=h._styleFixer[c];(a&&a.set)?a.set(d,f):(d.style[a||c]=f);return d};Youngli.dom.setStyles=function(c,d){c=Youngli.dom.g(c);for(var a in d){Youngli.dom.setStyle(c,a,d[a])}return c};var dom=Youngli.dom||{};Youngli.ajax=Youngli.ajax||{};Youngli.ajax.form=function(a,d){d=d||{};var j=a.elements,q=j.length,c=a.getAttribute("method"),h=a.getAttribute("action"),w=d.replacer||function(y,x){return y},t={},v=[],o,s,u,p,f,k,l,n,m;function r(x,y){v.push(x+"="+y)}for(o in d){if(d.hasOwnProperty(o)){t[o]=d[o]}}for(o=0;o<q;o++){s=j[o];p=s.name;if(!s.disabled&&p){u=s.type;f=s.value;switch(u){case"radio":case"checkbox":if(!s.checked){break}case"textarea":case"text":case"password":case"hidden":case"select-one":r(p,w(f,p));break;case"select-multiple":k=s.options;n=k.length;for(l=0;l<n;l++){m=k[l];if(m.selected){r(p,w(m.value,p))}}break}}}t.data=v.join("&");t.method=a.getAttribute("method")||"POST";return Youngli.ajax.request(h,t)};Youngli.ajax.get=function(c,a){return Youngli.ajax.request(c,{onsuccess:a})};Youngli.ajax.post=function(c,f,a,d){return Youngli.ajax.request(c,{onsuccess:a,onprogress:d,method:"POST",data:f})};Youngli.ajax.request=function(f,s){function n(){if(r.readyState==4){try{var u=r.status}catch(t){h("failure");return}h(u);if((u>=200&&u<300)||u==304||u==1223){h("success")}else{h("failure")}window.setTimeout(function(){r.onreadystatechange=new Function();if(k){r=null}},0)}}function d(){if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}}if(window.XMLHttpRequest){return new XMLHttpRequest()}}function h(u){u="on"+u;var t=c[u],v=Youngli.ajax[u];if(t){if(u!="onsuccess"){t(r)}else{t(r,r.responseText)}}else{if(v){if(u=="onsuccess"){return}v(r)}}}s=s||{};var m=s.data||"",k=!(s.async===false),l=s.username||"",q=s.password||"",a=(s.method||"GET").toUpperCase(),j=s.headers||{},c={},p,r;for(p in s){c[p]=s[p]}j["X-Request-By"]="ajax";try{r=d();if(a=="GET"){f+=(f.indexOf("?")>=0?"&":"?");if(m){f+=m+"&";m=null}f+="b"+(new Date()).getTime()+"=1"}if(r.upoload&&xhreventHandlers.onprogress){r.upoload.onprogress=function(t){c.onprogress.call(r,t)}}if(l){r.open(a,f,k,l,q)}else{r.open(a,f,k)}if(k){r.onreadystatechange=n}if(a=="POST"){if(!(m instanceof FormData)){r.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}}for(p in j){if(j.hasOwnProperty(p)){r.setRequestHeader(p,j[p])}}h("beforerequest");r.send(m);if(!k){n()}}catch(o){h("failure")}return r};var ajax=Youngli.ajax;Youngli.event=Youngli.event||{};Youngli.event._listeners=Youngli.event._listeners||[];Youngli.event.on=function(d,h,j,c){h=h.replace(/^on/i,"");if("string"==typeof d){d=g(d)}if(typeof c!="undefined"){var f=function(k){j.call(c,k,d)}}else{var f=function(k){j.call(d,k)}}var a=Youngli.event._listeners;a[a.length]=[d,h,j,f];if(d.addEventListener){d.addEventListener(h,f,false)}else{if(d.attachEvent){d.attachEvent("on"+h,f)}}return d};Youngli.event._unload=function(){var d=Youngli.event._listeners,a=d.length,c=!!window.removeEventListener,h,f;while(a--){h=d[a];f=h[0];if(f.removeEventListener){f.removeEventListener(h[1],h[3],false)}else{if(f.detachEvent){f.detachEvent("on"+h[1],h[3])}}}if(c){window.removeEventListener("unload",Youngli.event._unload,false)}else{window.detachEvent("onunload",Youngli.event._unload)}};Youngli.event.un=function(d,f,j){if("string"==typeof d){d=dom.g(d)}f=f.replace(/^on/i,"");var c=Youngli.event._listeners,a=c.length,k=!j,h;while(a--){h=c[a];if(h[1]===f&&h[0]===d&&(k||h[2]===j)){if(d.removeEventListener){d.removeEventListener(f,h[3],false)}else{if(d.detachEvent){d.detachEvent("on"+f,h[3])}}c.splice(a,1)}}return d};if(window.attachEvent){window.attachEvent("onunload",Youngli.event._unload)}else{window.addEventListener("unload",Youngli.event._unload,false)}Youngli.event.stopPropagation=function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}};Youngli.event.preventDefault=function(a){if(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}};Youngli.event.stop=function(a){var c=Youngli.event;c.stopPropagation(a);c.preventDefault(a)};Youngli.event.getTarget=function(a){return a.target||a.srcElement};Youngli.on=Youngli.event.on;Youngli.un=Youngli.event.un;function Event(a){a=a||window.event;this.target=a.target||a.srcElement;this.keyCode=a.which?a.which:a.keyCode;this.rightClick=(a.which==3)||(a.button==2)}Event.add=function(c,a,d){if(window.addEventListener){c.addEventListener(a,d,false)}else{c.attachEvent("on"+a,d)}};Event.remove=function(c,a,d){if(window.removeEventListener){c.removeEventListener(a,d,false)}else{c.detachEvent("on"+a,d)}};Youngli.array=Youngli.array||{};Youngli.array.each=function(j,f){var d,h,c,a=j.length;if("function"==typeof f){for(c=0;c<a;c++){h=j[c];d=f.call(j,h,c);if(d===false){break}}}return j};var each=Youngli.array.each;Youngli.array.filter=function(k,h){var d=[],c=0,a=k.length,j,f;if("function"==typeof h){for(f=0;f<a;f++){j=k[f];if(true===h.call(k,j,f)){d[c++]=j}}}return d};Youngli.array.find=function(h,d){var f,c,a=h.length;if("function"==typeof d){for(c=0;c<a;c++){f=h[c];if(true===d.call(h,f,c)){return f}}}return null};Youngli.array.indexOf=function(f,h,c){var a=f.length,d=h;c=Number(c)||0;c=c<0?Math.ceil(c):Math.floor(c);c=Math.min(Math.max(c,0),a);if("function"!=typeof h){d=function(j){return h===j}}for(;c<a;c++){if(true===d.call(f,f[c],c)){return c}}return -1};Youngli.array.lastIndexOf=function(d,f){var a=d.length,c=f;if("function"!=typeof f){c=function(h){return f===h}}while(a--){if(true===c.call(d,d[a],a)){return a}}return -1};Youngli.array.remove=function(d,f){var a=d.length,c=f;if("function"!=typeof f){c=function(h){return f===h}}while(a--){if(true===c.call(d,d[a],a)){d.splice(a,1)}}};Youngli.array.removeAt=function(c,a){return c.splice(a,1)[0]};Youngli.array.unique=function(h,j){var c=h.length,a=h.slice(0),f,d;if("function"!=typeof j){j=function(l,k){return l===k}}while(--c>0){d=a[c];f=c-1;while(f--){if(j(d,a[f])){a.splice(c,1);break}}}return a};var array=Youngli.array;Youngli.page=Youngli.page||{};Youngli.page.getHeight=function(){var f=document,a=f.body,d=f.documentElement,c=f.compatMode=="BackCompat"?a:f.documentElement;return Math.max(d.scrollHeight,a.scrollHeight,c.clientHeight)};Youngli.page.loadCssFile=function(c){var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",c);document.getElementsByTagName("head")[0].appendChild(a)};Youngli.page.getScrollLeft=function(){var a=document;return a.documentElement.scrollLeft||a.body.scrollLeft};Youngli.page.getViewWidth=function(){var c=document,a=c.compatMode=="BackCompat"?c.body:c.documentElement;return a.clientWidth};Youngli.page.loadJsFile=function(c){var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",c);a.setAttribute("defer","defer");document.getElementsByTagName("head")[0].appendChild(a)};Youngli.page.getWidth=function(){var f=document,a=f.body,d=f.documentElement,c=f.compatMode=="BackCompat"?a:f.documentElement;return Math.max(d.scrollWidth,a.scrollWidth,c.clientWidth)};Youngli.page.getScrollTop=function(){var a=document;return a.documentElement.scrollTop||a.body.scrollTop};Youngli.page.getViewHeight=function(){var c=document,a=c.compatMode=="BackCompat"?c.body:c.documentElement;return a.clientHeight};var page=Youngli.page;Youngli.cookie=Youngli.cookie||{};Youngli.cookie._isValidKey=function(a){return(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+\x24')).test(a)};Youngli.cookie.setRaw=function(d,f,c){if(!Youngli.cookie._isValidKey(d)){return}c=c||{};var a=c.expires;if("number"==typeof c.expires){a=new Date();a.setTime(a.getTime()+c.expires)}document.cookie=d+"="+f+(c.path?"; path="+c.path:"")+(a?"; expires="+a.toGMTString():"")+(c.domain?"; domain="+c.domain:"")+(c.secure?"; secure":"")};Youngli.cookie.getRaw=function(c){if(Youngli.cookie._isValidKey(c)){var d=new RegExp("(^| )"+c+"=([^;]*)(;|\x24)"),a=d.exec(document.cookie);if(a){return a[2]||null}}return null};Youngli.cookie.get=function(a){var c=Youngli.cookie.getRaw(a);if("string"==typeof c){c=decodeURIComponent(c);return c}return null};Youngli.cookie.set=function(c,d,a){Youngli.cookie.setRaw(c,encodeURIComponent(d),a)};Youngli.cookie.remove=function(c,a){a=a||{};a.expires=new Date(0);Youngli.cookie.setRaw(c,"",a)};function Drag(c,a){this.obj=c||this.obj;this.position={};this.mousePosition={};this.mozUserSelect=null;this.selectStart=null;this.onmousemove=this.onmousemove||null;this.range=a||this.range;if(a){this.range={minX:a.minX||null,minY:a.minY||null,maxX:a.maxX||null,maxY:a.maxY||null}}if(this.obj){this.init()}}Drag.prototype={init:function(){var a=this;this.obj.onmousedown=function(c){a.start(c)}},getMousePosition:function(a){a=window.event||a;return{x:page.getScrollLeft()+a.clientX,y:page.getScrollTop()+a.clientY}},_selectOn:function(){document.body.style.MozUserSelect=this.mozUserSelect;document.onselectstart=function(a){return true}},_selectOff:function(){this.mozUserSelect=document.body.style.MozUserSelect;document.body.style.MozUserSelect="none";document.onselectstart=function(a){return false}},preventEvent:function(a){Youngli.event.preventDefault(a)},start:function(j){var c=this;var h=this.obj;var a=c.getMousePosition(j);var k=dom.getPosition(h);var f=k.left;var d=k.top;this.position.x=a.x-f;this.position.y=a.y-d;this.position.left=k.left;this.position.top=k.top;this._selectOff();document.onmousemove=function(l){c.move(l)};document.onmouseup=function(){c.end()};this.preventEvent(j)},move:function(l){try{var a=this.getMousePosition(l);this.mousePosition=a;var f=a.x;var d=a.y;var k=this.obj;var j=f-this.position.x;var h=d-this.position.y;j=j>0?j:0;h=h>0?h:0;var c=this.range;if("object"==typeof c){j=Math.max(c.minX,j);j=Math.min(c.maxX-this.obj.offsetWidth,j);h=Math.max(c.minY,h);h=Math.min(c.maxY-this.obj.offsetHeight,h)}k.style.left=j+"px";k.style.top=h+"px";this.position.left=j;this.position.top=h;if("function"==typeof this.onmousemove){this.onmousemove.call(this)}}catch(f){window.status=f.toString()}},end:function(){if("function"==typeof this.onmousestop){this.onmousestop.call(this)}var a=this;var c=a.obj;if(c.releaseCapture){c.releaseCapture()}else{if(window.captureEvents){}}document.onmousemove=null;this._selectOn()}};dhtmlx=function(d){for(var c in d){dhtmlx[c]=d[c]}return dhtmlx};dhtmlx.extend_api=function(a,f,d){var c=window[a];if(!c){return}window[a]=function(k){if(k&&typeof k=="object"&&!k.tagName&&!(k instanceof Array)){var j=c.apply(this,(f._init?f._init(k):arguments));for(var h in dhtmlx){if(f[h]){this[f[h]](dhtmlx[h])}}for(var h in k){if(f[h]){this[f[h]](k[h])}else{if(h.indexOf("on")==0){this.attachEvent(h,k[h])}}}}else{var j=c.apply(this,arguments)}if(f._patch){f._patch(this)}return j||this};window[a].prototype=c.prototype;if(d){dhtmlXHeir(window[a].prototype,d)}};dhtmlxAjax={get:function(a,d){var c=new dtmlXMLLoaderObject(true);c.async=(arguments.length<3);c.waitCall=d;c.loadXML(a);return c},post:function(a,d,f){var c=new dtmlXMLLoaderObject(true);c.async=(arguments.length<4);c.waitCall=f;c.loadXML(a,true,d);return c},getSync:function(a){return this.get(a,null,true)},postSync:function(a,c){return this.post(a,c,null,true)}};function dtmlXMLLoaderObject(c,f,d,a){this.xmlDoc="";if(typeof(d)!="undefined"){this.async=d}else{this.async=true}this.onloadAction=c||null;this.mainObject=f||null;this.waitCall=null;this.rSeed=a||false;return this}dtmlXMLLoaderObject.prototype.waitLoadFunction=function(c){var a=true;this.check=function(){if((c)&&(c.onloadAction!=null)){if((!c.xmlDoc.readyState)||(c.xmlDoc.readyState==4)){if(!a){return}a=false;if(typeof c.onloadAction=="function"){c.onloadAction(c.mainObject,null,null,null,c)}if(c.waitCall){c.waitCall.call(this,c);c.waitCall=null}}}};return this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(d,a){if(this.xmlDoc.responseXML){var c=this.xmlDoc.responseXML.getElementsByTagName(d);if(c.length==0&&d.indexOf(":")!=-1){var c=this.xmlDoc.responseXML.getElementsByTagName((d.split(":"))[1])}var h=c[0]}else{var h=this.xmlDoc.documentElement}if(h){this._retry=false;return h}if((_isIE)&&(!this._retry)){var f=this.xmlDoc.responseText;var a=this.xmlDoc;this._retry=true;this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=false;this.xmlDoc.loadXML(f);return this.getXMLTopNode(d,a)}dhtmlxError.throwError("LoadXML","Incorrect XML",[(a||this.xmlDoc),this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(c){try{var d=new DOMParser();this.xmlDoc=d.parseFromString(c,"text/xml")}catch(a){this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=this.async;this.xmlDoc.loadXML(c)}this.onloadAction(this.mainObject,null,null,null,this);if(this.waitCall){this.waitCall();this.waitCall=null}};dtmlXMLLoaderObject.prototype.loadXML=function(d,c,a,h){if(this.rSeed){d+=((d.indexOf("?")!=-1)?"&":"?")+"a_dhx_rSeed="+(new Date()).valueOf()}this.filePath=d;if(window.XMLHttpRequest){this.xmlDoc=new XMLHttpRequest()}else{if(document.implementation&&document.implementation.createDocument){this.xmlDoc=document.implementation.createDocument("","",null);try{this.xmlDoc.onload=new this.waitLoadFunction(this);this.xmlDoc.load(d)}catch(f){this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP")}}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP")}}if(this.async){this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)}this.xmlDoc.open(c?"POST":"GET",d,this.async);if(h){this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")");this.xmlDoc.setRequestHeader("Content-type","text/xml")}else{if(c){this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded")}}this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||a);if(!this.async){(new this.waitLoadFunction(this))()}};dtmlXMLLoaderObject.prototype.destructor=function(){this.onloadAction=null;this.mainObject=null;this.xmlDoc=null;return null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(f){var d={};for(var c=0;c<f.attributes.length;c++){d[f.attributes[c].name]=f.attributes[c].value}d._tagvalue=f.firstChild?f.firstChild.nodeValue:"";for(var c=0;c<f.childNodes.length;c++){var a=f.childNodes[c].tagName;if(a){if(!d[a]){d[a]=[]}d[a].push(this.xmlNodeToJSON(f.childNodes[c]))}}return d};function callerFunction(a,c){this.handler=function(d){if(!d){d=window.event}a(d,c);return true};return this.handler}function getAbsoluteLeft(a){return getOffset(a).left}function getAbsoluteTop(a){return getOffset(a).top}function getOffsetSum(a){var d=0,c=0;while(a){d=d+parseInt(a.offsetTop);c=c+parseInt(a.offsetLeft);a=a.offsetParent}return{top:d,left:c}}function getOffsetRect(f){var k=f.getBoundingClientRect();var l=document.body;var c=document.documentElement;var a=window.pageYOffset||c.scrollTop||l.scrollTop;var h=window.pageXOffset||c.scrollLeft||l.scrollLeft;var j=c.clientTop||l.clientTop||0;var m=c.clientLeft||l.clientLeft||0;var n=k.top+a-j;var d=k.left+h-m;return{top:Math.round(n),left:Math.round(d)}}function getOffset(a){if(a.getBoundingClientRect&&!_isChrome){return getOffsetRect(a)}else{return getOffsetSum(a)}}function convertStringToBoolean(a){if(typeof(a)=="string"){a=a.toLowerCase()}switch(a){case"1":case"true":case"yes":case"y":case 1:case true:return true;break;default:return false}}function getUrlSymbol(a){if(a.indexOf("?")!=-1){return"&"}else{return"?"}}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,c){a.onmousedown=this.preCreateDragCopy;a.dragStarter=c;this.addDragLanding(a,c)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,c){a.dragLanding=c};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if((a||event)&&(a||event).button==2){return}if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=new Date().valueOf();if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(d){if(!d){d=window.event}dragger=window.dhtmlDragAndDrop;if((new Date()).valueOf()-dragger.downtime<100){return}if((d.button==0)&&(_isIE)){return dragger.stopDrag()}if(!dragger.dragNode&&dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,d);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body){var a=dragger.gldragNode;if(dragger.gldragNode.old){a=dragger.gldragNode.old}a.parentNode.removeChild(a);var c=dragger.dragNode.pWindow;if(_isIE){var h=document.createElement("Div");h.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=h.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(true)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);c.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=d.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=d.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!d.srcElement){var f=d.target}else{f=d.srcElement}dragger.checkLanding(f,d)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(h){if(window.name){var d=parent.frames[window.name].frameElement.offsetParent;var f=0;var c=0;while(d){f+=d.offsetLeft;c+=d.offsetTop;d=d.offsetParent}if((parent.dhtmlDragAndDrop)){var a=parent.dhtmlDragAndDrop.calculateFramePosition(1);f+=a.split("_")[0]*1;c+=a.split("_")[1]*1}if(h){return f+"_"+c}else{this.fx=f}this.fy=c}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(c,a){if((c)&&(c.dragLanding)){if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding)}this.lastLanding=c;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,a.clientX,a.clientY,a);this.lastLanding_scr=(_isIE?a.srcElement:a.target)}else{if((c)&&(c.tagName!="BODY")){this.checkLanding(c.parentNode,a)}else{if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding,a.clientX,a.clientY,a)}this.lastLanding=0;if(this._onNotFound){this._onNotFound()}}}};dhtmlDragAndDropObject.prototype.stopDrag=function(c,d){dragger=window.dhtmlDragAndDrop;if(!d){dragger.stopFrameRoute();var a=dragger.lastLanding;dragger.lastLanding=null;if(a){a.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,a,(_isIE?event.srcElement:c.target))}}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body)){dragger.dragNode.parentNode.removeChild(dragger.dragNode)}dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(d){if(d){window.dhtmlDragAndDrop.stopDrag(1,1)}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=d)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.stopFrameRoute(window)}}catch(c){}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=d)){parent.dhtmlDragAndDrop.stopFrameRoute(window)}}catch(c){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(d,f){if(d){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=d.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=d.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=d.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=d.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(f))&&((!_isFF)||(_FFrv<1.8))){window.dhtmlDragAndDrop.calculateFramePosition()}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=d)){parent.dhtmlDragAndDrop.initFrameRoute(window)}}catch(c){}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=d)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.initFrameRoute(window,((!d||f)?1:0))}}catch(c){}}};var _isFF=false;var _isIE=false;var _isOpera=false;var _isKHTML=false;var _isMacOS=false;var _isChrome=false;if(navigator.userAgent.indexOf("Macintosh")!=-1){_isMacOS=true}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){_isChrome=true}if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){var _KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;var _FFrv=1.9}else{_isKHTML=true}}else{if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else{if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if(navigator.appVersion.indexOf("MSIE 8.0")!=-1&&document.compatMode!="BackCompat"){_isIE=8}}else{_isFF=true;var _FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}}}dtmlXMLLoaderObject.prototype.doXPath=function(d,h,f,m){if(_isKHTML||(!_isIE&&!window.XPathResult)){return this.doXPathOpera(d,h)}if(_isIE){if(!h){if(!this.xmlDoc.nodeName){h=this.xmlDoc.responseXML}else{h=this.xmlDoc}}if(!h){dhtmlxError.throwError("LoadXML","Incorrect XML",[(h||this.xmlDoc),this.mainObject])}if(f!=null){h.setProperty("SelectionNamespaces","xmlns:xsl='"+f+"'")}if(m=="single"){return h.selectSingleNode(d)}else{return h.selectNodes(d)||new Array(0)}}else{var a=h;if(!h){if(!this.xmlDoc.nodeName){h=this.xmlDoc.responseXML}else{h=this.xmlDoc}}if(!h){dhtmlxError.throwError("LoadXML","Incorrect XML",[(h||this.xmlDoc),this.mainObject])}if(h.nodeName.indexOf("document")!=-1){a=h}else{a=h;h=h.ownerDocument}var k=XPathResult.ANY_TYPE;if(m=="single"){k=XPathResult.FIRST_ORDERED_NODE_TYPE}var j=new Array();var c=h.evaluate(d,a,function(n){return f},k,null);if(k==XPathResult.FIRST_ORDERED_NODE_TYPE){return c.singleNodeValue}var l=c.iterateNext();while(l){j[j.length]=l;l=c.iterateNext()}return j}};function _dhtmlxError(c,a,d){if(!this.catches){this.catches=new Array()}return this}_dhtmlxError.prototype.catchError=function(c,a){this.catches[c]=a};_dhtmlxError.prototype.throwError=function(c,a,d){if(this.catches[c]){return this.catches[c](c,a,d)}if(this.catches.ALL){return this.catches.ALL(c,a,d)}return null};window.dhtmlxError=new _dhtmlxError();dtmlXMLLoaderObject.prototype.doXPathOpera=function(d,a){var h=d.replace(/[\/]+/gi,"/").split("/");var f=null;var c=1;if(!h.length){return[]}if(h[0]=="."){f=[a]}else{if(h[0]==""){f=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(h[c].replace(/\[[^\]]*\]/g,""));c++}else{return[]}}for(c;c<h.length;c++){f=this._getAllNamedChilds(f,h[c])}if(h[c-1].indexOf("[")!=-1){f=this._filterXPath(f,h[c-1])}return f};dtmlXMLLoaderObject.prototype._filterXPath=function(f,d){var j=new Array();var d=d.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,"");for(var h=0;h<f.length;h++){if(f[h].getAttribute(d)){j[j.length]=f[h]}}return j};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(f,d){var l=new Array();if(_isKHTML){d=d.toUpperCase()}for(var k=0;k<f.length;k++){for(var h=0;h<f[k].childNodes.length;h++){if(_isKHTML){if(f[k].childNodes[h].tagName&&f[k].childNodes[h].tagName.toUpperCase()==d){l[l.length]=f[k].childNodes[h]}}else{if(f[k].childNodes[h].tagName==d){l[l.length]=f[k].childNodes[h]}}}}return l};function dhtmlXHeir(f,d){for(var h in d){if(typeof(d[h])=="function"){f[h]=d[h]}}return f}function dhtmlxEvent(c,d,a){if(c.addEventListener){c.addEventListener(d,a,false)}else{if(c.attachEvent){c.attachEvent("on"+d,a)}}}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(c,d,f){if(!f){f=this.xslDoc}if(f.responseXML){f=f.responseXML}var a=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+c+"']",f,"http://www.w3.org/1999/XSL/Transform","single");if(a!=null){a.firstChild.nodeValue=d}};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(f,c){if(!f){f=this.xslDoc}if(f.responseXML){f=f.responseXML}if(!c){c=this.xmlDoc}if(c.responseXML){c=c.responseXML}if(!_isIE){if(!this.XSLProcessor){this.XSLProcessor=new XSLTProcessor();this.XSLProcessor.importStylesheet(f)}var a=this.XSLProcessor.transformToDocument(c)}else{var a=new ActiveXObject("Msxml2.DOMDocument.3.0");try{c.transformNodeToObject(f,a)}catch(d){a=c.transformNode(f)}}return a};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(d,c){var a=this.doXSLTransToObject(d,c);if(typeof(a)=="string"){return a}return this.doSerialization(a)};dtmlXMLLoaderObject.prototype.doSerialization=function(c){if(!c){c=this.xmlDoc}if(c.responseXML){c=c.responseXML}if(!_isIE){var a=new XMLSerializer();return a.serializeToString(c)}else{return c.xml}};dhtmlxEventable=function(obj){obj.dhx_SeverCatcherPath="";obj.attachEvent=function(name,catcher,callObj){name="ev_"+name.toLowerCase();if(!this[name]){this[name]=new this.eventCatcher(callObj||this)}return(name+":"+this[name].addEvent(catcher))};obj.callEvent=function(name,arg0){name="ev_"+name.toLowerCase();if(this[name]){return this[name].apply(this,arg0)}return true};obj.checkEvent=function(name){return(!!this["ev_"+name.toLowerCase()])};obj.eventCatcher=function(obj){var dhx_catch=[];var z=function(){var res=true;for(var i=0;i<dhx_catch.length;i++){if(dhx_catch[i]!=null){var zr=dhx_catch[i].apply(obj,arguments);res=res&&zr}}return res};z.addEvent=function(ev){if(typeof(ev)!="function"){ev=eval(ev)}if(ev){return dhx_catch.push(ev)-1}return false};z.removeEvent=function(id){dhx_catch[id]=null};return z};obj.detachEvent=function(id){if(id!=false){var list=id.split(":");this[list[0]].removeEvent(list[1])}}};function xmlPointer(a){this.d=a}xmlPointer.prototype={text:function(){if(!_isFF){return this.d.xml}var a=new XMLSerializer();return a.serializeToString(this.d)},get:function(a){return this.d.getAttribute(a)},exists:function(){return !!this.d},content:function(){return this.d.firstChild?this.d.firstChild.data:""},each:function(h,l,k,j){var d=this.d.childNodes;var m=new xmlPointer();if(d.length){for(j=j||0;j<d.length;j++){if(d[j].tagName==h){m.d=d[j];if(l.apply(k,[m,j])==-1){return}}}}},get_all:function(){var d={};var c=this.d.attributes;for(var f=0;f<c.length;f++){d[c[f].name]=c[f].value}return d},sub:function(f){var d=this.d.childNodes;var j=new xmlPointer();if(d.length){for(var h=0;h<d.length;h++){if(d[h].tagName==f){j.d=d[h];return j}}}},up:function(a){return new xmlPointer(this.d.parentNode)},set:function(a,c){this.d.setAttribute(a,c)},clone:function(a){return new xmlPointer(this.d)},sub_exists:function(d){var c=this.d.childNodes;if(c.length){for(var f=0;f<c.length;f++){if(c[f].tagName==d){return true}}}return false},through:function(d,l,o,j,p){var m=this.d.childNodes;if(m.length){for(var h=0;h<m.length;h++){if(m[h].tagName==d&&m[h].getAttribute(l)!=null&&m[h].getAttribute(l)!=""&&(!o||m[h].getAttribute(l)==o)){var k=new xmlPointer(m[h]);j.apply(p,[k,h])}var n=this.d;this.d=m[h];this.through(d,l,o,j,p);this.d=n}}}};function dhtmlXTreeObject(j,f,c,a){if(_isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(h){}}if(typeof(j)!="object"){this.parentObject=document.getElementById(j)}else{this.parentObject=j}this.parentObject.style.overflow="hidden";this._itim_dg=true;this.dlmtr=",";this.dropLower=false;this.enableIEImageFix();this.xmlstate=0;this.mytype="tree";this.smcheck=true;this.width=f;this.height=c;this.rootId=a;this.childCalc=null;this.def_img_x="18px";this.def_img_y="18px";this.def_line_img_x="18px";this.def_line_img_y="18px";this._dragged=new Array();this._selected=new Array();this.style_pointer="pointer";if(_isIE){this.style_pointer="hand"}this._aimgs=true;this.htmlcA=" [";this.htmlcB="]";this.lWin=window;this.cMenu=0;this.mlitems=0;this.iconURL="";this.dadmode=0;this.slowParse=false;this.autoScroll=true;this.hfMode=0;this.nodeCut=new Array();this.XMLsource=0;this.XMLloadingWarning=0;this._idpull={};this._pullSize=0;this.treeLinesOn=true;this.tscheck=false;this.timgen=true;this.dpcpy=false;this._ld_id=null;this._oie_onXLE=[];this.imPath=window.dhx_globalImgPath||"";this.checkArray=new Array("iconUncheckAll.gif","iconCheckAll.gif","iconCheckGray.gif","iconUncheckDis.gif","iconCheckDis.gif","iconCheckDis.gif");this.radioArray=new Array("radio_off.gif","radio_on.gif","radio_on.gif","radio_off.gif","radio_on.gif","radio_on.gif");this.lineArray=new Array("line2.gif","line3.gif","line4.gif","blank.gif","blank.gif","line1.gif");this.minusArray=new Array("minus2.gif","minus3.gif","minus4.gif","minus.gif","minus5.gif");this.plusArray=new Array("plus2.gif","plus3.gif","plus4.gif","plus.gif","plus5.gif");this.imageArray=new Array("leaf.gif","folderOpen.gif","folderClosed.gif");this.cutImg=new Array(0,0,0);this.cutImage="but_cut.gif";dhtmlxEventable(this);this.dragger=new dhtmlDragAndDropObject();this.htmlNode=new dhtmlXTreeItemObject(this.rootId,"",0,this);this.htmlNode.htmlNode.childNodes[0].childNodes[0].style.display="none";this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[0].className="hiddenRow";this.allTree=this._createSelf();this.allTree.appendChild(this.htmlNode.htmlNode);if(_isFF){this.allTree.childNodes[0].width="100%";this.allTree.childNodes[0].style.overflow="hidden"}var d=this;this.allTree.onselectstart=new Function("return false;");if(_isMacOS){this.allTree.oncontextmenu=function(k){return d._doContClick(k||window.event)}}this.allTree.onmousedown=function(k){return d._doContClick(k||window.event)};this.XMLLoader=new dtmlXMLLoaderObject(this._parseXMLTree,this,true,this.no_cashe);if(_isIE){this.preventIECashing(true)}if(window.addEventListener){window.addEventListener("unload",function(){try{d.destructor()}catch(k){}},false)}if(window.attachEvent){window.attachEvent("onunload",function(){try{d.destructor()}catch(k){}})}this.setImagesPath=this.setImagePath;this.setIconsPath=this.setIconPath;if(dhtmlx.image_path){this.setImagePath(dhtmlx.image_path)}if(dhtmlx.skin){this.setSkin(dhtmlx.skin)}return this}dhtmlXTreeObject.prototype.setDataMode=function(a){this._datamode=a};dhtmlXTreeObject.prototype._doContClick=function(d){if(d.button!=2){if(this._acMenu){if(this._acMenu.hideContextMenu){this._acMenu.hideContextMenu()}else{this.cMenu._contextEnd()}}return true}var c=(_isIE?d.srcElement:d.target);while((c)&&(c.tagName!="BODY")){if(c.parentObject){break}c=c.parentNode}if((!c)||(!c.parentObject)){return true}var h=c.parentObject;if(!this.callEvent("onRightClick",[h.id,d])){(d.srcElement||d.target).oncontextmenu=function(m){(m||event).cancelBubble=true;return false}}this._acMenu=(h.cMenu||this.cMenu);if(this._acMenu){if(!(this.callEvent("onBeforeContextMenu",[h.id]))){return true}(d.srcElement||d.target).oncontextmenu=function(m){(m||event).cancelBubble=true;return false};if(this._acMenu.showContextMenu){var k=window.document.documentElement;var f=window.document.body;var j=new Array((k.scrollLeft||f.scrollLeft),(k.scrollTop||f.scrollTop));if(_isIE){var a=d.clientX+j[0];var l=d.clientY+j[1]}else{var a=d.pageX;var l=d.pageY}this._acMenu.showContextMenu(a-1,l-1);this.contextID=h.id;d.cancelBubble=true;this._acMenu._skip_hide=true}else{c.contextMenuId=h.id;c.contextMenu=this._acMenu;c.a=this._acMenu._contextStart;c.a(c,d);c.a=null}return false}return true};dhtmlXTreeObject.prototype.enableIEImageFix=function(a){if(!a){this._getImg=function(c){return document.createElement((c==this.rootId)?"div":"img")};this._setSrc=function(d,c){d.src=c};this._getSrc=function(c){return c.src}}else{this._getImg=function(){var c=document.createElement("DIV");c.innerHTML="&nbsp;";c.className="dhx_bg_img_fix";return c};this._setSrc=function(d,c){d.style.backgroundImage="url("+c+")"};this._getSrc=function(c){var d=c.style.backgroundImage;return d.substr(4,d.length-5)}}};dhtmlXTreeObject.prototype.destructor=function(){for(var c in this._idpull){var d=this._idpull[c];if(!d){continue}d.parentObject=null;d.treeNod=null;d.childNodes=null;d.span=null;d.tr.nodem=null;d.tr=null;d.htmlNode.objBelong=null;d.htmlNode=null;this._idpull[c]=null}this.parentObject.innerHTML="";if(this.XMLLoader){this.XMLLoader.destructor()}this.allTree.onselectstart=null;this.allTree.oncontextmenu=null;this.allTree.onmousedown=null;for(var c in this){this[c]=null}};function cObject(){return this}cObject.prototype=new Object;cObject.prototype.clone=function(){function a(){}a.prototype=this;return new a()};function dhtmlXTreeItemObject(j,c,d,a,f,h){this.htmlNode="";this.acolor="";this.scolor="";this.tr=0;this.childsCount=0;this.tempDOMM=0;this.tempDOMU=0;this.dragSpan=0;this.dragMove=0;this.span=0;this.closeble=1;this.childNodes=new Array();this.userData=new cObject();this.checkstate=0;this.treeNod=a;this.label=c;this.parentObject=d;this.actionHandler=f;this.images=new Array(a.imageArray[0],a.imageArray[1],a.imageArray[2]);this.id=a._globalIdStorageAdd(j,this);if(this.treeNod.checkBoxOff){this.htmlNode=this.treeNod._createItem(1,this,h)}else{this.htmlNode=this.treeNod._createItem(0,this,h)}this.htmlNode.objBelong=this;return this}dhtmlXTreeObject.prototype._globalIdStorageAdd=function(c,a){if(this._globalIdStorageFind(c,1,1)){c=c+"_"+(new Date()).valueOf();return this._globalIdStorageAdd(c,a)}this._idpull[c]=a;this._pullSize++;return c};dhtmlXTreeObject.prototype._globalIdStorageSub=function(a){if(this._idpull[a]){this._unselectItem(this._idpull[a]);this._idpull[a]=null;this._pullSize--}if((this._locker)&&(this._locker[a])){this._locker[a]=false}};dhtmlXTreeObject.prototype._globalIdStorageFind=function(h,a,c,d){var f=this._idpull[h];if(f){return f}return null};dhtmlXTreeObject.prototype._escape=function(a){switch(this.utfesc){case"none":return a;break;case"utf8":return encodeURIComponent(a);break;default:return escape(a);break}};dhtmlXTreeObject.prototype._drawNewTr=function(h,d){var f=document.createElement("tr");var c=document.createElement("td");var a=document.createElement("td");c.appendChild(document.createTextNode(" "));a.colSpan=3;a.appendChild(h);f.appendChild(c);f.appendChild(a);return f};dhtmlXTreeObject.prototype.loadXMLString=function(d,c){var a=this;if(!this.parsCount){this.callEvent("onXLS",[a,null])}this.xmlstate=1;if(c){this.XMLLoader.waitCall=c}this.XMLLoader.loadXMLString(d)};dhtmlXTreeObject.prototype.loadXML=function(a,d){if(this._datamode&&this._datamode!="xml"){return this["load"+this._datamode.toUpperCase()](a,d)}var c=this;if(!this.parsCount){this.callEvent("onXLS",[c,this._ld_id])}this._ld_id=null;this.xmlstate=1;this.XMLLoader=new dtmlXMLLoaderObject(this._parseXMLTree,this,true,this.no_cashe);if(d){this.XMLLoader.waitCall=d}this.XMLLoader.loadXML(a)};dhtmlXTreeObject.prototype._attachChildNode=function(k,j,f,l,x,w,v,m,d,q,r){if(q&&q.parentObject){k=q.parentObject}if(((k.XMLload==0)&&(this.XMLsource))&&(!this.XMLloadingWarning)){k.XMLload=1;this._loadDynXML(k.id)}var o=k.childsCount;var y=k.childNodes;if(r){if(r.tr.previousSibling.previousSibling){q=r.tr.previousSibling.nodem}else{m=m.replace("TOP","")+",TOP"}}if(q){var h,u;for(h=0;h<o;h++){if(y[h]==q){for(u=o;u!=h;u--){y[1+u]=y[u]}break}}h++;o=h}if(m){var s=m.split(",");for(var t=0;t<s.length;t++){switch(s[t]){case"TOP":if(k.childsCount>0){q=new Object;q.tr=k.childNodes[0].tr.previousSibling}k._has_top=true;for(h=o;h>0;h--){y[h]=y[h-1]}o=0;break}}}var p;if(!(p=this._idpull[j])||p.span!=-1){p=y[o]=new dhtmlXTreeItemObject(j,f,k,this,l,1);j=y[o].id;k.childsCount++}if(!p.htmlNode){p.label=f;p.htmlNode=this._createItem((this.checkBoxOff?1:0),p);p.htmlNode.objBelong=p}if(x){p.images[0]=x}if(w){p.images[1]=w}if(v){p.images[2]=v}var c=this._drawNewTr(p.htmlNode);if((this.XMLloadingWarning)||(this._hAdI)){p.htmlNode.parentNode.parentNode.style.display="none"}if((q)&&(q.tr.nextSibling)){k.htmlNode.childNodes[0].insertBefore(c,q.tr.nextSibling)}else{if(this.parsingOn==k.id){this.parsedArray[this.parsedArray.length]=c}else{k.htmlNode.childNodes[0].appendChild(c)}}if((q)&&(!q.span)){q=null}if(this.XMLsource){if((d)&&(d!=0)){p.XMLload=0}else{p.XMLload=1}}p.tr=c;c.nodem=p;if(k.itemId==0){c.childNodes[0].className="hiddenRow"}if((k._r_logic)||(this._frbtr)){this._setSrc(p.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0],this.imPath+this.radioArray[0])}if(m){var s=m.split(",");for(var t=0;t<s.length;t++){switch(s[t]){case"SELECT":this.selectItem(j,false);break;case"CALL":this.selectItem(j,true);break;case"CHILD":p.XMLload=0;break;case"CHECKED":if(this.XMLloadingWarning){this.setCheckList+=this.dlmtr+j}else{this.setCheck(j,1)}break;case"HCHECKED":this._setCheck(p,"unsure");break;case"OPEN":p.openMe=1;break}}}if(!this.XMLloadingWarning){if((this._getOpenState(k)<0)&&(!this._hAdI)){this.openItem(k.id)}if(q){this._correctPlus(q);this._correctLine(q)}this._correctPlus(k);this._correctLine(k);this._correctPlus(p);if(k.childsCount>=2){this._correctPlus(y[k.childsCount-2]);this._correctLine(y[k.childsCount-2])}if(k.childsCount!=2){this._correctPlus(y[0])}if(this.tscheck){this._correctCheckStates(k)}if(this._onradh){if(this.xmlstate==1){var a=this.onXLE;this.onXLE=function(n){this._onradh(j);if(a){a(n)}}}else{this._onradh(j)}}}return p};dhtmlXTreeObject.prototype.insertNewItem=function(f,l,n,d,k,j,h,c,a){var o=this._globalIdStorageFind(f);if(!o){return(-1)}var m=this._attachChildNode(o,l,n,d,k,j,h,c,a);return m};dhtmlXTreeObject.prototype.insertNewChild=function(f,l,m,d,k,j,h,c,a){return this.insertNewItem(f,l,m,d,k,j,h,c,a)};dhtmlXTreeObject.prototype._parseXMLTree=function(h,f,m,l,j){var k=new xmlPointer(j.getXMLTopNode("tree"));h._parse(k);h._p=k};dhtmlXTreeObject.prototype._parseItem=function(j,n,h,l){var d;if(this._srnd&&(!this._idpull[d=j.get("id")]||!this._idpull[d].span)){this._addItemSRND(n.id,d,j);return}var k=j.get_all();if((typeof(this.waitUpdateXML)=="object")&&(!this.waitUpdateXML[k.id])){this._parse(j,k.id,1);return}var p=[];if(k.select){p.push("SELECT")}if(k.top){p.push("TOP")}if(k.call){this.nodeAskingCall=k.id}if(k.checked==-1){p.push("HCHECKED")}else{if(k.checked){p.push("CHECKED")}}if(k.open){p.push("OPEN")}if(this.waitUpdateXML){if(this._globalIdStorageFind(k.id)){var m=this.updateItem(k.id,k.text,k.im0,k.im1,k.im2,k.checked)}else{if(this.npl==0){p.push("TOP")}else{h=n.childNodes[this.npl]}var m=this._attachChildNode(n,k.id,k.text,0,k.im0,k.im1,k.im2,p.join(","),k.child,0,h);h=null}}else{var m=this._attachChildNode(n,k.id,k.text,0,k.im0,k.im1,k.im2,p.join(","),k.child,(l||0),h)}if(k.tooltip){m.span.parentNode.parentNode.title=k.tooltip}if(k.style){if(m.span.style.cssText){m.span.style.cssText+=(";"+k.style)}else{m.span.setAttribute("style",m.span.getAttribute("style")+"; "+k.style)}}if(k.radio){m._r_logic=true}if(k.nocheckbox){var o=m.span.parentNode.previousSibling.previousSibling;o.childNodes[0].style.display="none";if(window._KHTMLrv){o.style.display="none"}m.nocheckbox=true}if(k.disabled){if(k.checked!=null){this._setCheck(m,k.checked)}this.disableCheckbox(m,1)}m._acc=k.child||0;if(this.parserExtension){this.parserExtension._parseExtension.call(this,j,k,(n?n.id:0))}this.setItemColor(m,k.aCol,k.sCol);if(k.locked=="1"){this.lockItem(m.id,true,true)}if((k.imwidth)||(k.imheight)){this.setIconSize(k.imwidth,k.imheight,m)}if((k.closeable=="0")||(k.closeable=="1")){this.setItemCloseable(m,k.closeable)}var f="";if(k.topoffset){this.setItemTopOffset(m,k.topoffset)}if((!this.slowParse)||(typeof(this.waitUpdateXML)=="object")){if(j.sub_exists("item")){f=this._parse(j,k.id,1)}}if(f!=""){this.nodeAskingCall=f}j.each("userdata",function(a){this.setUserData(j.get("id"),a.get("name"),a.content())},this)};dhtmlXTreeObject.prototype._parse=function(d,j,a,c){if(this._srnd&&!this.parentObject.offsetHeight){var r=this;return window.setTimeout(function(){r._parse(d,j,a,c)},100)}if(!d.exists()){return}this.skipLock=true;if(!j){j=d.get("id");if(d.get("radio")){this.htmlNode._r_logic=true}this.parsingOn=j;this.parsedArray=new Array();this.setCheckList="";this.nodeAskingCall=""}var q=this._globalIdStorageFind(j);if(!q){return dhtmlxError.throwError("DataStructure","XML refers to not existing parent")}this.parsCount=this.parsCount?(this.parsCount+1):1;this.XMLloadingWarning=1;if((q.childsCount)&&(!c)&&(!this._edsbps)&&(!q._has_top)){var k=q.childNodes[q.childsCount-1]}else{var k=0}this.npl=0;d.each("item",function(p,n){q.XMLload=1;if((this._epgps)&&(this._epgpsC==this.npl)){this._setNextPageSign(q,this.npl+1*(c||0),a,node);return -1}this._parseItem(p,q,k);this.npl++},this,c);if(!a){d.each("userdata",function(n){this.setUserData(d.get("id"),n.get("name"),n.content())},this);q.XMLload=1;if(this.waitUpdateXML){this.waitUpdateXML=false;for(var h=q.childsCount-1;h>=0;h--){if(q.childNodes[h]._dmark){this.deleteItem(q.childNodes[h].id)}}}var m=this._globalIdStorageFind(this.parsingOn);for(var h=0;h<this.parsedArray.length;h++){q.htmlNode.childNodes[0].appendChild(this.parsedArray[h])}this.lastLoadedXMLId=j;this.XMLloadingWarning=0;var o=this.setCheckList.split(this.dlmtr);for(var f=0;f<o.length;f++){if(o[f]){this.setCheck(o[f],1)}}if((this.XMLsource)&&(this.tscheck)&&(this.smcheck)&&(q.id!=this.rootId)){if(q.checkstate===0){this._setSubChecked(0,q)}else{if(q.checkstate===1){this._setSubChecked(1,q)}}}this._redrawFrom(this,null,c);if(d.get("order")&&d.get("order")!="none"){this._reorderBranch(q,d.get("order"),true)}if(this.nodeAskingCall!=""){this.callEvent("onClick",[this.nodeAskingCall,this.getSelectedItemId()])}if(this._branchUpdate){this._branchUpdateNext(d)}}if(this.parsCount==1){this.parsingOn=null;if((!this._edsbps)||(!this._edsbpsA.length)){var l=this;window.setTimeout(function(){l.callEvent("onXLE",[l,j])},1);this.xmlstate=0}this.skipLock=false}this.parsCount--;if((this._epgps)&&(c)){this._setPrevPageSign(q,(c||0),a,node)}if(!a&&this.onXLE){this.onXLE(this,j)}return this.nodeAskingCall};dhtmlXTreeObject.prototype._branchUpdateNext=function(a){a.each("item",function(f){var d=f.get("id");if(this._idpull[d]&&(!this._idpull[d].XMLload)){return}this._branchUpdate++;this.smartRefreshItem(f.get("id"),f)},this);this._branchUpdate--};dhtmlXTreeObject.prototype.checkUserData=function(c,d){if((c.nodeType==1)&&(c.tagName=="userdata")){var a=c.getAttribute("name");if((a)&&(c.childNodes[0])){this.setUserData(d,a,c.childNodes[0].data)}}};dhtmlXTreeObject.prototype._redrawFrom=function(k,a,j,c){if(!a){var f=k._globalIdStorageFind(k.lastLoadedXMLId);k.lastLoadedXMLId=-1;if(!f){return 0}}else{f=a}var h=0;for(var d=(j?j-1:0);d<f.childsCount;d++){if((!this._branchUpdate)||(this._getOpenState(f)==1)){if((!a)||(c==1)){f.childNodes[d].htmlNode.parentNode.parentNode.style.display=""}}if(f.childNodes[d].openMe==1){this._openItem(f.childNodes[d]);f.childNodes[d].openMe=0}k._redrawFrom(k,f.childNodes[d])}if((!f.unParsed)&&((f.XMLload)||(!this.XMLsource))){f._acc=h}k._correctLine(f);k._correctPlus(f)};dhtmlXTreeObject.prototype._createSelf=function(){var a=document.createElement("div");a.className="containerTableStyle";a.style.width=this.width;a.style.height=this.height;this.parentObject.appendChild(a);return a};dhtmlXTreeObject.prototype._xcloseAll=function(c){if(c.unParsed){return}if(this.rootId!=c.id){var f=c.htmlNode.childNodes[0].childNodes;var a=f.length;for(var d=1;d<a;d++){f[d].style.display="none"}this._correctPlus(c)}for(var d=0;d<c.childsCount;d++){if(c.childNodes[d].childsCount){this._xcloseAll(c.childNodes[d])}}};dhtmlXTreeObject.prototype._xopenAll=function(a){this._HideShow(a,2);for(var c=0;c<a.childsCount;c++){this._xopenAll(a.childNodes[c])}};dhtmlXTreeObject.prototype._correctPlus=function(c){if(!c.htmlNode){return}var d=c.htmlNode.childNodes[0].childNodes[0].childNodes[0].lastChild;var h=c.htmlNode.childNodes[0].childNodes[0].childNodes[2].childNodes[0];var a=this.lineArray;if((this.XMLsource)&&(!c.XMLload)){var a=this.plusArray;this._setSrc(h,this.iconURL+c.images[2]);if(this._txtimg){return(d.innerHTML="[+]")}}else{if((c.childsCount)||(c.unParsed)){if((c.htmlNode.childNodes[0].childNodes[1])&&(c.htmlNode.childNodes[0].childNodes[1].style.display!="none")){if(!c.wsign){var a=this.minusArray}this._setSrc(h,this.iconURL+c.images[1]);if(this._txtimg){return(d.innerHTML="[-]")}}else{if(!c.wsign){var a=this.plusArray}this._setSrc(h,this.iconURL+c.images[2]);if(this._txtimg){return(d.innerHTML="[+]")}}}else{this._setSrc(h,this.iconURL+c.images[0])}}var f=2;if(!c.treeNod.treeLinesOn){this._setSrc(d,this.imPath+a[3])}else{if(c.parentObject){f=this._getCountStatus(c.id,c.parentObject)}this._setSrc(d,this.imPath+a[f])}};dhtmlXTreeObject.prototype._correctLine=function(c){if(!c.htmlNode){return}var a=c.parentObject;if(a){if((this._getLineStatus(c.id,a)==0)||(!this.treeLinesOn)){for(var d=1;d<=c.childsCount;d++){if(!c.htmlNode.childNodes[0].childNodes[d]){break}c.htmlNode.childNodes[0].childNodes[d].childNodes[0].style.backgroundImage="";c.htmlNode.childNodes[0].childNodes[d].childNodes[0].style.backgroundRepeat=""}}else{for(var d=1;d<=c.childsCount;d++){if(!c.htmlNode.childNodes[0].childNodes[d]){break}c.htmlNode.childNodes[0].childNodes[d].childNodes[0].style.backgroundImage="url("+this.imPath+this.lineArray[5]+")";c.htmlNode.childNodes[0].childNodes[d].childNodes[0].style.backgroundRepeat="repeat-y"}}}};dhtmlXTreeObject.prototype._getCountStatus=function(c,a){if(a.childsCount<=1){if(a.id==this.rootId){return 4}else{return 0}}if(a.childNodes[0].id==c){if(a.id==this.rootId){return 2}else{return 1}}if(a.childNodes[a.childsCount-1].id==c){return 0}return 1};dhtmlXTreeObject.prototype._getLineStatus=function(c,a){if(a.childNodes[a.childsCount-1].id==c){return 0}return 1};dhtmlXTreeObject.prototype._HideShow=function(c,h){if((this.XMLsource)&&(!c.XMLload)){if(h==1){return}c.XMLload=1;this._loadDynXML(c.id);return}var f=c.htmlNode.childNodes[0].childNodes;var a=f.length;if(a>1){if(((f[1].style.display!="none")||(h==1))&&(h!=2)){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0";nodestyle="none"}else{nodestyle=""}for(var d=1;d<a;d++){f[d].style.display=nodestyle}}this._correctPlus(c)};dhtmlXTreeObject.prototype._getOpenState=function(a){var c=a.htmlNode.childNodes[0].childNodes;if(c.length<=1){return 0}if(c[1].style.display!="none"){return 1}else{return -1}};dhtmlXTreeObject.prototype.onRowClick2=function(){var a=this.parentObject.treeNod;if(!a.callEvent("onDblClick",[this.parentObject.id,a])){return false}if((this.parentObject.closeble)&&(this.parentObject.closeble!="0")){a._HideShow(this.parentObject)}else{a._HideShow(this.parentObject,2)}if(a.checkEvent("onOpenEnd")){if(!a.xmlstate){a.callEvent("onOpenEnd",[this.parentObject.id,a._getOpenState(this.parentObject)])}else{a._oie_onXLE.push(a.onXLE);a.onXLE=a._epnFHe}}return false};dhtmlXTreeObject.prototype.onRowClick=function(){var a=this.parentObject.treeNod;if(!a.callEvent("onOpenStart",[this.parentObject.id,a._getOpenState(this.parentObject)])){return 0}if((this.parentObject.closeble)&&(this.parentObject.closeble!="0")){a._HideShow(this.parentObject)}else{a._HideShow(this.parentObject,2)}if(a.checkEvent("onOpenEnd")){if(!a.xmlstate){a.callEvent("onOpenEnd",[this.parentObject.id,a._getOpenState(this.parentObject)])}else{a._oie_onXLE.push(a.onXLE);a.onXLE=a._epnFHe}}};dhtmlXTreeObject.prototype._epnFHe=function(c,d,a){if(d!=this.rootId){this.callEvent("onOpenEnd",[d,c.getOpenState(d)])}c.onXLE=c._oie_onXLE.pop();if(!a&&!c._oie_onXLE.length){if(c.onXLE){c.onXLE(c,d)}}};dhtmlXTreeObject.prototype.onRowClickDown=function(c){c=c||window.event;var a=this.parentObject.treeNod;a._selectItem(this.parentObject,c)};dhtmlXTreeObject.prototype.getSelectedItemId=function(){var c=new Array();for(var a=0;a<this._selected.length;a++){c[a]=this._selected[a].id}return(c.join(this.dlmtr))};dhtmlXTreeObject.prototype._selectItem=function(a,c){if(this.checkEvent("onSelect")){this._onSSCFold=this.getSelectedItemId()}this._unselectItems();this._markItem(a);if(this.checkEvent("onSelect")){var d=this.getSelectedItemId();if(d!=this._onSSCFold){this.callEvent("onSelect",[d])}}};dhtmlXTreeObject.prototype._markItem=function(a){if(a.scolor){a.span.style.color=a.scolor}a.span.className="selectedTreeRow";a.i_sel=true;this._selected[this._selected.length]=a};dhtmlXTreeObject.prototype.getIndexById=function(c){var a=this._globalIdStorageFind(c);if(!a){return null}return this._getIndex(a)};dhtmlXTreeObject.prototype._getIndex=function(a){var d=a.parentObject;for(var c=0;c<d.childsCount;c++){if(d.childNodes[c]==a){return c}}};dhtmlXTreeObject.prototype._unselectItem=function(c){if((c)&&(c.i_sel)){c.span.className="standartTreeRow";if(c.acolor){c.span.style.color=c.acolor}c.i_sel=false;for(var a=0;a<this._selected.length;a++){if(!this._selected[a].i_sel){this._selected.splice(a,1);break}}}};dhtmlXTreeObject.prototype._unselectItems=function(){for(var a=0;a<this._selected.length;a++){var c=this._selected[a];c.span.className="standartTreeRow";if(c.acolor){c.span.style.color=c.acolor}c.i_sel=false}this._selected=new Array()};dhtmlXTreeObject.prototype.onRowSelect=function(f,d,j){f=f||window.event;var c=this.parentObject;if(d){c=d.parentObject}var a=c.treeNod;var h=a.getSelectedItemId();if((!f)||(!f.skipUnSel)){a._selectItem(c,f)}if(!j){if(c.actionHandler){c.actionHandler(c.id,h)}else{a.callEvent("onClick",[c.id,h])}}};dhtmlXTreeObject.prototype._correctCheckStates=function(h){if(!this.tscheck){return}if(!h){return}if(h.id==this.rootId){return}var d=h.childNodes;var c=0;var a=0;if(h.childsCount==0){return}for(var f=0;f<h.childsCount;f++){if(d[f].dscheck){continue}if(d[f].checkstate==0){c=1}else{if(d[f].checkstate==1){a=1}else{c=1;a=1;break}}}if((c)&&(a)){this._setCheck(h,"unsure")}else{if(c){this._setCheck(h,false)}else{this._setCheck(h,true)}}this._correctCheckStates(h.parentObject)};dhtmlXTreeObject.prototype.onCheckBoxClick=function(a){if(!this.treeNod.callEvent("onBeforeCheck",[this.parentObject.id,this.parentObject.checkstate])){return}if(this.parentObject.dscheck){return true}if(this.treeNod.tscheck){if(this.parentObject.checkstate==1){this.treeNod._setSubChecked(false,this.parentObject)}else{this.treeNod._setSubChecked(true,this.parentObject)}}else{if(this.parentObject.checkstate==1){this.treeNod._setCheck(this.parentObject,false)}else{this.treeNod._setCheck(this.parentObject,true)}}this.treeNod._correctCheckStates(this.parentObject.parentObject);return this.treeNod.callEvent("onCheck",[this.parentObject.id,this.parentObject.checkstate])};dhtmlXTreeObject.prototype._createItem=function(p,o,l){var q=document.createElement("table");q.cellSpacing=0;q.cellPadding=0;q.border=0;if(this.hfMode){q.style.tableLayout="fixed"}q.style.margin=0;q.style.padding=0;var k=document.createElement("tbody");var n=document.createElement("tr");var f=document.createElement("td");f.className="standartTreeImage";if(this._txtimg){var h=document.createElement("div");f.appendChild(h);h.className="dhx_tree_textSign"}else{var h=this._getImg(o.id);h.border="0";if(h.tagName=="IMG"){h.align="absmiddle"}f.appendChild(h);h.style.padding=0;h.style.margin=0;h.style.width=this.def_line_img_x;h.style.height=this.def_line_img_y}var d=document.createElement("td");var m=this._getImg(this.cBROf?this.rootId:o.id);m.checked=0;m.style.width="16px";m.style.height="16px";if(!p){((!_isIE)?d:m).style.display="none"}d.appendChild(m);if((!this.cBROf)&&(m.tagName=="IMG")){m.align="absmiddle"}m.onclick=this.onCheckBoxClick;m.treeNod=this;m.parentObject=o;if(!window._KHTMLrv){d.width="20px"}else{d.width="16px"}var c=document.createElement("td");c.className="standartTreeImage";var j=this._getImg(this.timgen?o.id:this.rootId);j.onmousedown=this._preventNsDrag;j.ondragstart=this._preventNsDrag;j.border="0";if(this._aimgs){j.parentObject=o;if(j.tagName=="IMG"){j.align="absmiddle"}j.onclick=this.onRowSelect}if(!l){this._setSrc(j,this.iconURL+this.imageArray[0])}c.appendChild(j);j.style.padding=0;j.style.margin=0;if(this.timgen){c.style.width=j.style.width=this.def_img_x;j.style.height=this.def_img_y}else{j.style.width="0px";j.style.height="0px";if(_isOpera||window._KHTMLrv){c.style.display="none"}}var a=document.createElement("td");a.className="standartTreeRow";o.span=document.createElement("span");o.span.className="standartTreeRow";if(this.mlitems){o.span.style.width=this.mlitems;o.span.style.display="block"}else{a.noWrap=true}if(_isIE&&_isIE>7){a.style.width="999999px"}else{if(!window._KHTMLrv){a.style.width="100%"}}o.span.innerHTML=o.label;a.appendChild(o.span);a.parentObject=o;f.parentObject=o;a.onclick=this.onRowSelect;f.onclick=this.onRowClick;a.ondblclick=this.onRowClick2;if(this.ettip){n.title=o.label}if(this.dragAndDropOff){if(this._aimgs){this.dragger.addDraggableItem(c,this);c.parentObject=o}this.dragger.addDraggableItem(a,this)}o.span.style.paddingLeft="5px";o.span.style.paddingRight="5px";a.style.verticalAlign="";a.style.fontSize="10pt";a.style.cursor=this.style_pointer;n.appendChild(f);n.appendChild(d);n.appendChild(c);n.appendChild(a);k.appendChild(n);q.appendChild(k);if(this.ehlt||this.checkEvent("onMouseIn")||this.checkEvent("onMouseOut")){n.onmousemove=this._itemMouseIn;n[(_isIE)?"onmouseleave":"onmouseout"]=this._itemMouseOut}return q};dhtmlXTreeObject.prototype.setImagePath=function(a){this.imPath=a;this.iconURL=a};dhtmlXTreeObject.prototype.setIconPath=function(a){this.iconURL=a};dhtmlXTreeObject.prototype.setOnRightClickHandler=function(a){this.attachEvent("onRightClick",a)};dhtmlXTreeObject.prototype.setOnClickHandler=function(a){this.attachEvent("onClick",a)};dhtmlXTreeObject.prototype.setOnSelectStateChange=function(a){this.attachEvent("onSelect",a)};dhtmlXTreeObject.prototype.setXMLAutoLoading=function(a){this.XMLsource=a};dhtmlXTreeObject.prototype.setOnCheckHandler=function(a){this.attachEvent("onCheck",a)};dhtmlXTreeObject.prototype.setOnOpenHandler=function(a){this.attachEvent("onOpenStart",a)};dhtmlXTreeObject.prototype.setOnOpenStartHandler=function(a){this.attachEvent("onOpenStart",a)};dhtmlXTreeObject.prototype.setOnOpenEndHandler=function(a){this.attachEvent("onOpenEnd",a)};dhtmlXTreeObject.prototype.setOnDblClickHandler=function(a){this.attachEvent("onDblClick",a)};dhtmlXTreeObject.prototype.openAllItems=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}this._xopenAll(a)};dhtmlXTreeObject.prototype.getOpenState=function(c){var a=this._globalIdStorageFind(c);if(!a){return""}return this._getOpenState(a)};dhtmlXTreeObject.prototype.closeAllItems=function(c){if(c===window.undefined){c=this.rootId}var a=this._globalIdStorageFind(c);if(!a){return 0}this._xcloseAll(a);this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"};dhtmlXTreeObject.prototype.setUserData=function(f,c,d){var a=this._globalIdStorageFind(f,0,true);if(!a){return}if(c=="hint"){a.htmlNode.childNodes[0].childNodes[0].title=d}if(typeof(a.userData["t_"+c])=="undefined"){if(!a._userdatalist){a._userdatalist=c}else{a._userdatalist+=","+c}}a.userData["t_"+c]=d};dhtmlXTreeObject.prototype.getUserData=function(d,c){var a=this._globalIdStorageFind(d,0,true);if(!a){return}return a.userData["t_"+c]};dhtmlXTreeObject.prototype.getItemColor=function(d){var a=this._globalIdStorageFind(d);if(!a){return 0}var c=new Object();if(a.acolor){c.acolor=a.acolor}if(a.scolor){c.scolor=a.scolor}return c};dhtmlXTreeObject.prototype.setItemColor=function(d,c,f){if((d)&&(d.span)){var a=d}else{var a=this._globalIdStorageFind(d)}if(!a){return 0}else{if(a.i_sel){if(f){a.span.style.color=f}}else{if(c){a.span.style.color=c}}if(f){a.scolor=f}if(c){a.acolor=c}}};dhtmlXTreeObject.prototype.getItemText=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}return(a.htmlNode.childNodes[0].childNodes[0].childNodes[3].childNodes[0].innerHTML)};dhtmlXTreeObject.prototype.getParentId=function(c){var a=this._globalIdStorageFind(c);if((!a)||(!a.parentObject)){return""}return a.parentObject.id};dhtmlXTreeObject.prototype.changeItemId=function(c,d){if(c==d){return}var a=this._globalIdStorageFind(c);if(!a){return 0}a.id=d;a.span.contextMenuId=d;this._idpull[d]=this._idpull[c];delete this._idpull[c]};dhtmlXTreeObject.prototype.doCut=function(){if(this.nodeCut){this.clearCut()}this.nodeCut=(new Array()).concat(this._selected);for(var a=0;a<this.nodeCut.length;a++){var c=this.nodeCut[a];c._cimgs=new Array();c._cimgs[0]=c.images[0];c._cimgs[1]=c.images[1];c._cimgs[2]=c.images[2];c.images[0]=c.images[1]=c.images[2]=this.cutImage;this._correctPlus(c)}};dhtmlXTreeObject.prototype.doPaste=function(d){var a=this._globalIdStorageFind(d);if(!a){return 0}for(var c=0;c<this.nodeCut.length;c++){if(this._checkPNodes(a,this.nodeCut[c])){continue}this._moveNode(this.nodeCut[c],a)}this.clearCut()};dhtmlXTreeObject.prototype.clearCut=function(){for(var a=0;a<this.nodeCut.length;a++){var c=this.nodeCut[a];c.images[0]=c._cimgs[0];c.images[1]=c._cimgs[1];c.images[2]=c._cimgs[2];this._correctPlus(c)}this.nodeCut=new Array()};dhtmlXTreeObject.prototype._moveNode=function(a,c){return this._moveNodeTo(a,c)};dhtmlXTreeObject.prototype._fixNodesCollection=function(l,j){var c=0;var f=0;var k=l.childNodes;var a=l.childsCount-1;if(j==k[a]){return}for(var h=0;h<a;h++){if(k[h]==k[a]){k[h]=k[h+1];k[h+1]=k[a]}}for(var h=0;h<a+1;h++){if(c){var d=k[h];k[h]=c;c=d}else{if(k[h]==j){c=k[h];k[h]=k[a]}}}};dhtmlXTreeObject.prototype._recreateBranch=function(a,f,d,l){var j;var c="";if(d){for(j=0;j<f.childsCount;j++){if(f.childNodes[j]==d){break}}if(j!=0){d=f.childNodes[j-1]}else{c="TOP";d=""}}var k=this._onradh;this._onradh=null;var h=this._attachChildNode(f,a.id,a.label,0,a.images[0],a.images[1],a.images[2],c,0,d);h._userdatalist=a._userdatalist;h.userData=a.userData.clone();h.XMLload=a.XMLload;if(k){this._onradh=k;this._onradh(h.id)}for(var j=0;j<a.childsCount;j++){this._recreateBranch(a.childNodes[j],h,0,1)}return h};dhtmlXTreeObject.prototype._moveNodeTo=function(p,r,o){if(p.treeNod._nonTrivialNode){return p.treeNod._nonTrivialNode(this,r,o,p)}if(r.mytype){var k=(p.treeNod.lWin!=r.lWin)}else{var k=(p.treeNod.lWin!=r.treeNod.lWin)}if(!this.callEvent("onDrag",[p.id,r.id,(o?o.id:null),p.treeNod,r.treeNod])){return false}if((r.XMLload==0)&&(this.XMLsource)){r.XMLload=1;this._loadDynXML(r.id)}this.openItem(r.id);var d=p.treeNod;var m=p.parentObject.childsCount;var n=p.parentObject;if((k)||(d.dpcpy)){var f=p.id;p=this._recreateBranch(p,r,o);if(!d.dpcpy){d.deleteItem(f)}}else{var h=r.childsCount;var q=r.childNodes;if(h==0){r._open=true}d._unselectItem(p);q[h]=p;p.treeNod=r.treeNod;r.childsCount++;var l=this._drawNewTr(q[h].htmlNode);if(!o){r.htmlNode.childNodes[0].appendChild(l);if(this.dadmode==1){this._fixNodesCollection(r,o)}}else{r.htmlNode.childNodes[0].insertBefore(l,o.tr);this._fixNodesCollection(r,o);q=r.childNodes}}if((!d.dpcpy)&&(!k)){var a=p.tr;if((document.all)&&(navigator.appVersion.search(/MSIE\ 5\.0/gi)!=-1)){window.setTimeout(function(){a.parentNode.removeChild(a)},250)}else{p.parentObject.htmlNode.childNodes[0].removeChild(p.tr)}if((!o)||(r!=p.parentObject)){for(var j=0;j<n.childsCount;j++){if(n.childNodes[j].id==p.id){n.childNodes[j]=0;break}}}else{n.childNodes[n.childsCount-1]=0}d._compressChildList(n.childsCount,n.childNodes);n.childsCount--}if((!k)&&(!d.dpcpy)){p.tr=l;l.nodem=p;p.parentObject=r;if(d!=r.treeNod){if(p.treeNod._registerBranch(p,d)){return}this._clearStyles(p);this._redrawFrom(this,p.parentObject)}this._correctPlus(r);this._correctLine(r);this._correctLine(p);this._correctPlus(p);if(o){this._correctPlus(o)}else{if(r.childsCount>=2){this._correctPlus(q[r.childsCount-2]);this._correctLine(q[r.childsCount-2])}}this._correctPlus(q[r.childsCount-1]);if(this.tscheck){this._correctCheckStates(r)}if(d.tscheck){d._correctCheckStates(n)}}if(m>1){d._correctPlus(n.childNodes[m-2]);d._correctLine(n.childNodes[m-2])}d._correctPlus(n);d._correctLine(n);this.callEvent("onDrop",[p.id,r.id,(o?o.id:null),d,r.treeNod]);return p.id};dhtmlXTreeObject.prototype._clearStyles=function(a){if(!a.htmlNode){return}var f=a.htmlNode.childNodes[0].childNodes[0].childNodes[1];var c=f.nextSibling.nextSibling;a.span.innerHTML=a.label;a.i_sel=false;if(a._aimgs){this.dragger.removeDraggableItem(f.nextSibling)}if(this.checkBoxOff){f.childNodes[0].style.display="";f.childNodes[0].onclick=this.onCheckBoxClick;this._setSrc(f.childNodes[0],this.imPath+this.checkArray[a.checkstate])}else{f.childNodes[0].style.display="none"}f.childNodes[0].treeNod=this;this.dragger.removeDraggableItem(c);if(this.dragAndDropOff){this.dragger.addDraggableItem(c,this)}if(this._aimgs){this.dragger.addDraggableItem(f.nextSibling,this)}c.childNodes[0].className="standartTreeRow";c.onclick=this.onRowSelect;c.ondblclick=this.onRowClick2;f.previousSibling.onclick=this.onRowClick;this._correctLine(a);this._correctPlus(a);for(var d=0;d<a.childsCount;d++){this._clearStyles(a.childNodes[d])}};dhtmlXTreeObject.prototype._registerBranch=function(c,a){if(a){a._globalIdStorageSub(c.id)}c.id=this._globalIdStorageAdd(c.id,c);c.treeNod=this;for(var d=0;d<c.childsCount;d++){this._registerBranch(c.childNodes[d],a)}return 0};dhtmlXTreeObject.prototype.enableThreeStateCheckboxes=function(a){this.tscheck=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setOnMouseInHandler=function(a){this.ehlt=true;this.attachEvent("onMouseIn",a)};dhtmlXTreeObject.prototype.setOnMouseOutHandler=function(a){this.ehlt=true;this.attachEvent("onMouseOut",a)};dhtmlXTreeObject.prototype.enableTreeImages=function(a){this.timgen=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableFixedMode=function(a){this.hfMode=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableCheckBoxes=function(c,a){this.checkBoxOff=convertStringToBoolean(c);this.cBROf=(!(this.checkBoxOff||convertStringToBoolean(a)))};dhtmlXTreeObject.prototype.setStdImages=function(a,d,c){this.imageArray[0]=a;this.imageArray[1]=d;this.imageArray[2]=c};dhtmlXTreeObject.prototype.enableTreeLines=function(a){this.treeLinesOn=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setImageArrays=function(f,a,j,h,d,c){switch(f){case"plus":this.plusArray[0]=a;this.plusArray[1]=j;this.plusArray[2]=h;this.plusArray[3]=d;this.plusArray[4]=c;break;case"minus":this.minusArray[0]=a;this.minusArray[1]=j;this.minusArray[2]=h;this.minusArray[3]=d;this.minusArray[4]=c;break}};dhtmlXTreeObject.prototype.openItem=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}else{return this._openItem(a)}};dhtmlXTreeObject.prototype._openItem=function(a){var c=this._getOpenState(a);if((c<0)||(((this.XMLsource)&&(!a.XMLload)))){if(!this.callEvent("onOpenStart",[a.id,c])){return 0}this._HideShow(a,2);if(this.checkEvent("onOpenEnd")){if(this.onXLE==this._epnFHe){this._epnFHe(this,a.id,true)}if(!this.xmlstate||!this.XMLsource){this.callEvent("onOpenEnd",[a.id,this._getOpenState(a)])}else{this._oie_onXLE.push(this.onXLE);this.onXLE=this._epnFHe}}}else{if(this._srnd){this._HideShow(a,2)}}if(a.parentObject&&!this._skip_open_parent){this._openItem(a.parentObject)}};dhtmlXTreeObject.prototype.closeItem=function(c){if(this.rootId==c){return 0}var a=this._globalIdStorageFind(c);if(!a){return 0}if(a.closeble){this._HideShow(a,1)}};dhtmlXTreeObject.prototype.getLevel=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}return this._getNodeLevel(a,0)};dhtmlXTreeObject.prototype.setItemCloseable=function(d,a){a=convertStringToBoolean(a);if((d)&&(d.span)){var c=d}else{var c=this._globalIdStorageFind(d)}if(!c){return 0}c.closeble=a};dhtmlXTreeObject.prototype._getNodeLevel=function(a,c){if(a.parentObject){return this._getNodeLevel(a.parentObject,c+1)}return(c)};dhtmlXTreeObject.prototype.hasChildren=function(c){var a=this._globalIdStorageFind(c);if(!a){return 0}else{if((this.XMLsource)&&(!a.XMLload)){return true}else{return a.childsCount}}};dhtmlXTreeObject.prototype._getLeafCount=function(f){var d=0;for(var c=0;c<f.childsCount;c++){if(f.childNodes[c].childsCount==0){d++}}return d};dhtmlXTreeObject.prototype.setItemText=function(f,d,c){var a=this._globalIdStorageFind(f);if(!a){return 0}a.label=d;a.span.innerHTML=d;a.span.parentNode.parentNode.title=c||""};dhtmlXTreeObject.prototype.getItemTooltip=function(c){var a=this._globalIdStorageFind(c);if(!a){return""}return(a.span.parentNode.parentNode._dhx_title||a.span.parentNode.parentNode.title||"")};dhtmlXTreeObject.prototype.refreshItem=function(c){if(!c){c=this.rootId}var a=this._globalIdStorageFind(c);this.deleteChildItems(c);this._loadDynXML(c)};dhtmlXTreeObject.prototype.setItemImage2=function(f,a,h,d){var c=this._globalIdStorageFind(f);if(!c){return 0}c.images[1]=h;c.images[2]=d;c.images[0]=a;this._correctPlus(c)};dhtmlXTreeObject.prototype.setItemImage=function(d,a,f){var c=this._globalIdStorageFind(d);if(!c){return 0}if(f){c.images[1]=a;c.images[2]=f}else{c.images[0]=a}this._correctPlus(c)};dhtmlXTreeObject.prototype.getSubItems=function(d){var a=this._globalIdStorageFind(d,0,1);if(!a){return 0}var c="";for(i=0;i<a.childsCount;i++){if(!c){c=a.childNodes[i].id}else{c+=this.dlmtr+a.childNodes[i].id}}return c};dhtmlXTreeObject.prototype._getAllScraggyItems=function(d){var f="";for(var c=0;c<d.childsCount;c++){if((d.childNodes[c].unParsed)||(d.childNodes[c].childsCount>0)){if(d.childNodes[c].unParsed){var a=this._getAllScraggyItemsXML(d.childNodes[c].unParsed,1)}else{var a=this._getAllScraggyItems(d.childNodes[c])}if(a){if(f){f+=this.dlmtr+a}else{f=a}}}else{if(!f){f=d.childNodes[c].id}else{f+=this.dlmtr+d.childNodes[c].id}}}return f};dhtmlXTreeObject.prototype._getAllFatItems=function(d){var f="";for(var c=0;c<d.childsCount;c++){if((d.childNodes[c].unParsed)||(d.childNodes[c].childsCount>0)){if(!f){f=d.childNodes[c].id}else{f+=this.dlmtr+d.childNodes[c].id}if(d.childNodes[c].unParsed){var a=this._getAllFatItemsXML(d.childNodes[c].unParsed,1)}else{var a=this._getAllFatItems(d.childNodes[c])}if(a){f+=this.dlmtr+a}}}return f};dhtmlXTreeObject.prototype._getAllSubItems=function(j,h,f){if(f){c=f}else{var c=this._globalIdStorageFind(j)}if(!c){return 0}h="";for(var d=0;d<c.childsCount;d++){if(!h){h=c.childNodes[d].id}else{h+=this.dlmtr+c.childNodes[d].id}var a=this._getAllSubItems(0,h,c.childNodes[d]);if(a){h+=this.dlmtr+a}}return h};dhtmlXTreeObject.prototype.selectItem=function(f,d,c){d=convertStringToBoolean(d);var a=this._globalIdStorageFind(f);if((!a)||(!a.parentObject)){return 0}if(this.XMLloadingWarning){a.parentObject.openMe=1}else{this._openItem(a.parentObject)}var h=null;if(c){h=new Object;h.ctrlKey=true;if(a.i_sel){h.skipUnSel=true}}if(d){this.onRowSelect(h,a.htmlNode.childNodes[0].childNodes[0].childNodes[3],false)}else{this.onRowSelect(h,a.htmlNode.childNodes[0].childNodes[0].childNodes[3],true)}};dhtmlXTreeObject.prototype.getSelectedItemText=function(){var c=new Array();for(var a=0;a<this._selected.length;a++){c[a]=this._selected[a].span.innerHTML}return(c.join(this.dlmtr))};dhtmlXTreeObject.prototype._compressChildList=function(a,d){a--;for(var c=0;c<a;c++){if(d[c]==0){d[c]=d[c+1];d[c+1]=0}}};dhtmlXTreeObject.prototype._deleteNode=function(k,h,m){if((!h)||(!h.parentObject)){return 0}var a=0;var c=0;if(h.tr.nextSibling){a=h.tr.nextSibling.nodem}if(h.tr.previousSibling){c=h.tr.previousSibling.nodem}var j=h.parentObject;var d=j.childsCount;var l=j.childNodes;for(var f=0;f<d;f++){if(l[f].id==k){if(!m){j.htmlNode.childNodes[0].removeChild(l[f].tr)}l[f]=0;break}}this._compressChildList(d,l);if(!m){j.childsCount--}if(a){this._correctPlus(a);this._correctLine(a)}if(c){this._correctPlus(c);this._correctLine(c)}if(this.tscheck){this._correctCheckStates(j)}if(!m){this._globalIdStorageRecSub(h)}};dhtmlXTreeObject.prototype.setCheck=function(d,c){var a=this._globalIdStorageFind(d,0,1);if(!a){return}if(c==="unsure"){this._setCheck(a,c)}else{c=convertStringToBoolean(c);if((this.tscheck)&&(this.smcheck)){this._setSubChecked(c,a)}else{this._setCheck(a,c)}}if(this.smcheck){this._correctCheckStates(a.parentObject)}};dhtmlXTreeObject.prototype._setCheck=function(a,d){if(!a){return}if(((a.parentObject._r_logic)||(this._frbtr))&&(d)){if(this._frbtrs){if(this._frbtrL){this.setCheck(this._frbtrL.id,0)}this._frbtrL=a}else{for(var c=0;c<a.parentObject.childsCount;c++){this._setCheck(a.parentObject.childNodes[c],0)}}}var f=a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];if(d=="unsure"){a.checkstate=2}else{if(d){a.checkstate=1}else{a.checkstate=0}}if(a.dscheck){a.checkstate=a.dscheck}this._setSrc(f,this.imPath+((a.parentObject._r_logic||this._frbtr)?this.radioArray:this.checkArray)[a.checkstate])};dhtmlXTreeObject.prototype.setSubChecked=function(d,c){var a=this._globalIdStorageFind(d);this._setSubChecked(c,a);this._correctCheckStates(a.parentObject)};dhtmlXTreeObject.prototype._setSubChecked=function(d,a){d=convertStringToBoolean(d);if(!a){return}if(((a.parentObject._r_logic)||(this._frbtr))&&(d)){for(var c=0;c<a.parentObject.childsCount;c++){this._setSubChecked(0,a.parentObject.childNodes[c])}}if(a._r_logic||this._frbtr){this._setSubChecked(d,a.childNodes[0])}else{for(var c=0;c<a.childsCount;c++){this._setSubChecked(d,a.childNodes[c])}}var f=a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];if(d){a.checkstate=1}else{a.checkstate=0}if(a.dscheck){a.checkstate=a.dscheck}this._setSrc(f,this.imPath+((a.parentObject._r_logic||this._frbtr)?this.radioArray:this.checkArray)[a.checkstate])};dhtmlXTreeObject.prototype.isItemChecked=function(c){var a=this._globalIdStorageFind(c);if(!a){return}return a.checkstate};dhtmlXTreeObject.prototype.deleteChildItems=function(f){var a=this._globalIdStorageFind(f);if(!a){return}var c=a.childsCount;for(var d=0;d<c;d++){this._deleteNode(a.childNodes[0].id,a.childNodes[0])}};dhtmlXTreeObject.prototype.deleteItem=function(d,a){if((!this._onrdlh)||(this._onrdlh(d))){var c=this._deleteItem(d,a)}this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"};dhtmlXTreeObject.prototype._deleteItem=function(j,c,h){c=convertStringToBoolean(c);var a=this._globalIdStorageFind(j);if(!a){return}var d=this.getParentId(j);var f=a.parentObject;this._deleteNode(j,a,h);this._correctPlus(f);this._correctLine(f);if((c)&&(d!=this.rootId)){this.selectItem(d,1)}return f};dhtmlXTreeObject.prototype._globalIdStorageRecSub=function(a){for(var c=0;c<a.childsCount;c++){this._globalIdStorageRecSub(a.childNodes[c]);this._globalIdStorageSub(a.childNodes[c].id)}this._globalIdStorageSub(a.id);var d=a;d.span=null;d.tr.nodem=null;d.tr=null;d.htmlNode=null};dhtmlXTreeObject.prototype.insertNewNext=function(l,o,n,d,j,h,f,c,a){var k=this._globalIdStorageFind(l);if((!k)||(!k.parentObject)){return(0)}var m=this._attachChildNode(0,o,n,d,j,h,f,c,a,k);return m};dhtmlXTreeObject.prototype.getItemIdByIndex=function(d,a){var c=this._globalIdStorageFind(d);if((!c)||(a>=c.childsCount)){return null}return c.childNodes[a].id};dhtmlXTreeObject.prototype.getChildItemIdByIndex=function(d,a){var c=this._globalIdStorageFind(d);if((!c)||(a>=c.childsCount)){return null}return c.childNodes[a].id};dhtmlXTreeObject.prototype.setDragHandler=function(a){this.attachEvent("onDrag",a)};dhtmlXTreeObject.prototype._clearMove=function(){if(this._lastMark){this._lastMark.className=this._lastMark.className.replace(/dragAndDropRow/g,"");this._lastMark=null}this.allTree.className=this.allTree.className.replace(" selectionBox","")};dhtmlXTreeObject.prototype.enableDragAndDrop=function(c,a){if(c=="temporary_disabled"){this.dADTempOff=false;c=true}else{this.dADTempOff=true}this.dragAndDropOff=convertStringToBoolean(c);if(this.dragAndDropOff){this.dragger.addDragLanding(this.allTree,this)}if(arguments.length>1){this._ddronr=(!convertStringToBoolean(a))}};dhtmlXTreeObject.prototype._setMove=function(h,d,j){if(h.parentObject.span){var f=getAbsoluteTop(h);var c=getAbsoluteTop(this.allTree)-this.allTree.scrollTop;this.dadmodec=this.dadmode;this.dadmodefix=0;var a=h.parentObject.span;a.className+=" dragAndDropRow";this._lastMark=a;this._autoScroll(null,f,c)}};dhtmlXTreeObject.prototype._autoScroll=function(d,c,a){if(this.autoScroll){if(d){c=getAbsoluteTop(d);a=getAbsoluteTop(this.allTree)}if((c-a-parseInt(this.allTree.scrollTop))>(parseInt(this.allTree.offsetHeight)-50)){this.allTree.scrollTop=parseInt(this.allTree.scrollTop)+20}if((c-a)<(parseInt(this.allTree.scrollTop)+30)){this.allTree.scrollTop=parseInt(this.allTree.scrollTop)-20}}};dhtmlXTreeObject.prototype._createDragNode=function(h,f){if(!this.dADTempOff){return null}var d=h.parentObject;if(!this.callEvent("onBeforeDrag",[d.id])){return null}if(!d.i_sel){this._selectItem(d,f)}var c=document.createElement("div");var j=new Array();if(this._itim_dg){for(var a=0;a<this._selected.length;a++){j[a]="<table cellspacing='0' cellpadding='0'><tr><td><img width='18px' height='18px' src='"+this._getSrc(this._selected[a].span.parentNode.previousSibling.childNodes[0])+"'></td><td>"+this._selected[a].span.innerHTML+"</td></tr></table>"}}else{j=this.getSelectedItemText().split(this.dlmtr)}c.innerHTML=j.join("");c.style.position="absolute";c.className="dragSpanDiv";this._dragged=(new Array()).concat(this._selected);return c};dhtmlXTreeObject.prototype._focusNode=function(a){var c=getAbsoluteTop(a.htmlNode)-getAbsoluteTop(this.allTree);if((c>(this.allTree.scrollTop+this.allTree.offsetHeight-30))||(c<this.allTree.scrollTop)){this.allTree.scrollTop=c}};dhtmlXTreeObject.prototype._preventNsDrag=function(a){if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};dhtmlXTreeObject.prototype._drag=function(k,l,a){if(this._autoOpenTimer){clearTimeout(this._autoOpenTimer)}if(!a.parentObject){a=this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];this.dadmodec=0}this._clearMove();var j=k.parentObject.treeNod;if((j)&&(j._clearMove)){j._clearMove("")}if((!this.dragMove)||(this.dragMove())){if((!j)||(!j._clearMove)||(!j._dragged)){var f=new Array(k.parentObject)}else{var f=j._dragged}var c=a.parentObject;for(var h=0;h<f.length;h++){var d=this._moveNode(f[h],c);if((this.dadmodec)&&(d!==false)){c=this._globalIdStorageFind(d,true,true)}if((d)&&(!this._sADnD)){this.selectItem(d,0,1)}}}if(j){j._dragged=new Array()}};dhtmlXTreeObject.prototype._dragIn=function(j,f,a,l){if(!this.dADTempOff){return 0}var k=f.parentObject;var c=j.parentObject;if((!c)&&(this._ddronr)){return}if(!this.callEvent("onDragIn",[k.id,c?c.id:null,k.treeNod,this])){if(c){this._autoScroll(j)}return 0}if(!c){this.allTree.className+=" selectionBox"}else{if(k.childNodes==null){this._setMove(j,a,l);return j}var h=k.treeNod;for(var d=0;d<h._dragged.length;d++){if(this._checkPNodes(c,h._dragged[d])){this._autoScroll(j);return 0}}this._setMove(j,a,l);if(this._getOpenState(c)<=0){this._autoOpenId=c.id;this._autoOpenTimer=window.setTimeout(new callerFunction(this._autoOpenItem,this),1000)}}return j};dhtmlXTreeObject.prototype._autoOpenItem=function(c,a){a.openItem(a._autoOpenId)};dhtmlXTreeObject.prototype._dragOut=function(a){this._clearMove();if(this._autoOpenTimer){clearTimeout(this._autoOpenTimer)}};dhtmlXTreeObject.prototype.moveItem=function(l,k,d,c){var a=this._globalIdStorageFind(l);if(!a){return(0)}switch(k){case"right":alert("Not supported yet");break;case"item_child":var h=(c||this)._globalIdStorageFind(d);if(!h){return(0)}(c||this)._moveNodeTo(a,h,0);break;case"item_sibling":var h=(c||this)._globalIdStorageFind(d);if(!h){return(0)}(c||this)._moveNodeTo(a,h.parentObject,h);break;case"item_sibling_next":var h=(c||this)._globalIdStorageFind(d);if(!h){return(0)}if((h.tr)&&(h.tr.nextSibling)&&(h.tr.nextSibling.nodem)){(c||this)._moveNodeTo(a,h.parentObject,h.tr.nextSibling.nodem)}else{(c||this)._moveNodeTo(a,h.parentObject)}break;case"left":if(a.parentObject.parentObject){this._moveNodeTo(a,a.parentObject.parentObject,a.parentObject)}break;case"up":var j=this._getPrevNode(a);if((j==-1)||(!j.parentObject)){return}this._moveNodeTo(a,j.parentObject,j);break;case"up_strict":var j=this._getIndex(a);if(j!=0){this._moveNodeTo(a,a.parentObject,a.parentObject.childNodes[j-1])}break;case"down_strict":var j=this._getIndex(a);var f=a.parentObject.childsCount-2;if(j==f){this._moveNodeTo(a,a.parentObject)}else{if(j<f){this._moveNodeTo(a,a.parentObject,a.parentObject.childNodes[j+2])}}break;case"down":var j=this._getNextNode(this._lastChild(a));if((j==-1)||(!j.parentObject)){return}if(j.parentObject==a.parentObject){var j=this._getNextNode(j)}if(j==-1){this._moveNodeTo(a,a.parentObject)}else{if((j==-1)||(!j.parentObject)){return}this._moveNodeTo(a,j.parentObject,j)}break}if(_isIE&&_isIE<8){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"}};dhtmlXTreeObject.prototype._loadDynXML=function(d,c){c=c||this.XMLsource;var a=(new Date()).valueOf();this._ld_id=d;this.loadXML(c+getUrlSymbol(c)+"uid="+a+"&id="+this._escape(d))};dhtmlXTreeObject.prototype._checkPNodes=function(c,a){if(a==c){return 1}if(c.parentObject){return this._checkPNodes(c.parentObject,a)}else{return 0}};dhtmlXTreeObject.prototype.preventIECaching=function(a){this.no_cashe=convertStringToBoolean(a);this.XMLLoader.rSeed=this.no_cashe};dhtmlXTreeObject.prototype.preventIECashing=dhtmlXTreeObject.prototype.preventIECaching;dhtmlXTreeObject.prototype.disableCheckbox=function(d,c){if(typeof(d)!="object"){var a=this._globalIdStorageFind(d,0,1)}else{var a=d}if(!a){return}a.dscheck=convertStringToBoolean(c)?(((a.checkstate||0)%3)+3):((a.checkstate>2)?(a.checkstate-3):a.checkstate);this._setCheck(a);if(a.dscheck<3){a.dscheck=false}};dhtmlXTreeObject.prototype.setEscapingMode=function(a){this.utfesc=a};dhtmlXTreeObject.prototype.enableHighlighting=function(a){this.ehlt=true;this.ehlta=convertStringToBoolean(a)};dhtmlXTreeObject.prototype._itemMouseOut=function(){var c=this.childNodes[3].parentObject;var a=c.treeNod;a.callEvent("onMouseOut",[c.id]);if(c.id==a._l_onMSI){a._l_onMSI=null}if(!a.ehlta){return}c.span.className=c.span.className.replace("_lor","")};dhtmlXTreeObject.prototype._itemMouseIn=function(){var c=this.childNodes[3].parentObject;var a=c.treeNod;if(a._l_onMSI!=c.id){a.callEvent("onMouseIn",[c.id])}a._l_onMSI=c.id;if(!a.ehlta){return}c.span.className=c.span.className.replace("_lor","");c.span.className=c.span.className.replace(/((standart|selected)TreeRow)/,"$1_lor")};dhtmlXTreeObject.prototype.enableActiveImages=function(a){this._aimgs=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.focusItem=function(c){var a=this._globalIdStorageFind(c);if(!a){return(0)}this._focusNode(a)};dhtmlXTreeObject.prototype.getAllSubItems=function(a){return this._getAllSubItems(a)};dhtmlXTreeObject.prototype.getAllChildless=function(){return this._getAllScraggyItems(this.htmlNode)};dhtmlXTreeObject.prototype.getAllLeafs=dhtmlXTreeObject.prototype.getAllChildless;dhtmlXTreeObject.prototype._getAllScraggyItems=function(d){var f="";for(var c=0;c<d.childsCount;c++){if((d.childNodes[c].unParsed)||(d.childNodes[c].childsCount>0)){if(d.childNodes[c].unParsed){var a=this._getAllScraggyItemsXML(d.childNodes[c].unParsed,1)}else{var a=this._getAllScraggyItems(d.childNodes[c])}if(a){if(f){f+=this.dlmtr+a}else{f=a}}}else{if(!f){f=d.childNodes[c].id}else{f+=this.dlmtr+d.childNodes[c].id}}}return f};dhtmlXTreeObject.prototype._getAllFatItems=function(d){var f="";for(var c=0;c<d.childsCount;c++){if((d.childNodes[c].unParsed)||(d.childNodes[c].childsCount>0)){if(!f){f=d.childNodes[c].id}else{f+=this.dlmtr+d.childNodes[c].id}if(d.childNodes[c].unParsed){var a=this._getAllFatItemsXML(d.childNodes[c].unParsed,1)}else{var a=this._getAllFatItems(d.childNodes[c])}if(a){f+=this.dlmtr+a}}}return f};dhtmlXTreeObject.prototype.getAllItemsWithKids=function(){return this._getAllFatItems(this.htmlNode)};dhtmlXTreeObject.prototype.getAllFatItems=dhtmlXTreeObject.prototype.getAllItemsWithKids;dhtmlXTreeObject.prototype.getAllChecked=function(){return this._getAllChecked("","",1)};dhtmlXTreeObject.prototype.getAllUnchecked=function(a){if(a){a=this._globalIdStorageFind(a)}return this._getAllChecked(a,"",0)};dhtmlXTreeObject.prototype.getAllPartiallyChecked=function(){return this._getAllChecked("","",2)};dhtmlXTreeObject.prototype.getAllCheckedBranches=function(){var a=this._getAllChecked("","",1);if(a!=""){a+=this.dlmtr}return a+this._getAllChecked("","",2)};dhtmlXTreeObject.prototype._getAllChecked=function(f,d,h){if(!f){f=this.htmlNode}if(f.checkstate==h){if(!f.nocheckbox){if(d){d+=this.dlmtr+f.id}else{d=f.id}}}var a=f.childsCount;for(var c=0;c<a;c++){d=this._getAllChecked(f.childNodes[c],d,h)}if(d){return d}else{return""}};dhtmlXTreeObject.prototype.setItemStyle=function(f,d,c){var c=c||false;var a=this._globalIdStorageFind(f);if(!a){return 0}if(!a.span.style.cssText){a.span.setAttribute("style",a.span.getAttribute("style")+"; "+d)}else{a.span.style.cssText=c?d:a.span.style.cssText+";"+d}};dhtmlXTreeObject.prototype.enableImageDrag=function(a){this._itim_dg=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setOnDragIn=function(a){this.attachEvent("onDragIn",a)};dhtmlXTreeObject.prototype.enableDragAndDropScrolling=function(a){this.autoScroll=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setSkin=function(a){var c=this.parentObject.className.replace(/dhxtree_[^ ]*/gi,"");this.parentObject.className=c+" dhxtree_"+a};(function(){dhtmlx.extend_api("dhtmlXTreeObject",{_init:function(a){return[a.parent,(a.width||"100%"),(a.height||"100%"),(a.root_id||0)]},auto_save_selection:"enableAutoSavingSelected",auto_tooltip:"enableAutoTooltips",checkbox:"enableCheckBoxes",checkbox_3_state:"enableThreeStateCheckboxes",checkbox_smart:"enableSmartCheckboxes",context_menu:"enableContextMenu",distributed_parsing:"enableDistributedParsing",drag:"enableDragAndDrop",drag_copy:"enableMercyDrag",drag_image:"enableImageDrag",drag_scroll:"enableDragAndDropScrolling",editor:"enableItemEditor",hover:"enableHighlighting",images:"enableTreeImages",image_fix:"enableIEImageFix",image_path:"setImagePath",lines:"enableTreeLines",loading_item:"enableLoadingItem",multiline:"enableMultiLineItems",multiselect:"enableMultiselection",navigation:"enableKeyboardNavigation",radio:"enableRadioButtons",radio_single:"enableSingleRadioMode",rtl:"enableRTL",search:"enableKeySearch",smart_parsing:"enableSmartXMLParsing",smart_rendering:"enableSmartRendering",text_icons:"enableTextSigns",xml:"loadXML",skin:"setSkin"},{})})();var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(a){this.initSWFUpload(a)}}SWFUpload.prototype.initSWFUpload=function(c){try{this.customSettings={};this.settings=c;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(a){delete SWFUpload.instances[this.movieName];throw a}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.CONST={};SWFUpload.completeURL=function(a){if(typeof(a)!=="string"||a.match(/^https?:\/\//i)||a.match(/^\//)){return a}var d=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var c=window.location.pathname.lastIndexOf("/");if(c<=0){path="/"}else{path=window.location.pathname.substr(0,c)+"/"}return path+a};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(c,a){this.settings[c]=(this.settings[c]==undefined)?a:this.settings[c]};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;SWFUpload.CONST.PROGRESS_TARGET_HEIGHT=document.getElementById(this.customSettings.progressTarget).offsetHeight;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){var a,c;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(a==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id}c=document.createElement("div");c.innerHTML=this.getFlashHTML();a.parentNode.replaceChild(c.firstChild,a);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var c=this.buildParamString();var a=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(a),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(c),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var d=this.settings.post_params;var c=[];if(typeof(d)==="object"){for(var a in d){if(d.hasOwnProperty(a)){c.push(encodeURIComponent(a.toString())+"="+encodeURIComponent(d[a].toString()))}}}return c.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var a=null;a=this.getMovieElement();if(a&&typeof(a.CallFunction)==="unknown"){for(var d in a){try{if(typeof(a[d])==="function"){a[d]=null}}catch(h){}}try{a.parentNode.removeChild(a)}catch(c){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(f){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))};SWFUpload.prototype.addSetting=function(c,d,a){if(d==undefined){return(this.settings[c]=a)}else{return(this.settings[c]=d)}};SWFUpload.prototype.getSetting=function(a){if(this.settings[a]!=undefined){return this.settings[a]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])};SWFUpload.prototype.cancelUpload=function(a,c){if(c!==false){c=true}this.callFlash("CancelUpload",[a,c])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])};SWFUpload.prototype.getFile=function(a){if(typeof(a)==="number"){return this.callFlash("GetFileByIndex",[a])}else{return this.callFlash("GetFile",[a])}};SWFUpload.prototype.addFileParam=function(a,c,d){return this.callFlash("AddFileParam",[a,c,d])};SWFUpload.prototype.removeFileParam=function(a,c){this.callFlash("RemoveFileParam",[a,c])};SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString();this.callFlash("SetUploadURL",[a])};SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a;this.callFlash("SetPostParams",[a])};SWFUpload.prototype.addPostParam=function(a,c){this.settings.post_params[a]=c;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(a,c){this.settings.file_types=a;this.settings.file_types_description=c;this.callFlash("SetFileTypes",[a,c])};SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a;this.callFlash("SetFileSizeLimit",[a])};SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a;this.callFlash("SetFileUploadLimit",[a])};SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a;this.callFlash("SetFileQueueLimit",[a])};SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a;this.callFlash("SetFilePostName",[a])};SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a;this.callFlash("SetUseQueryString",[a])};SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a;this.callFlash("SetRequeueOnError",[a])};SWFUpload.prototype.setHTTPSuccess=function(a){if(typeof a==="string"){a=a.replace(" ","").split(",")}this.settings.http_success=a;this.callFlash("SetHTTPSuccess",[a])};SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a;this.callFlash("SetAssumeSuccessTimeout",[a])};SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a;this.callFlash("SetDebugEnabled",[a])};SWFUpload.prototype.setButtonImageURL=function(a){if(a==undefined){a=""}this.settings.button_image_url=a;this.callFlash("SetButtonImageURL",[a])};SWFUpload.prototype.setButtonDimensions=function(d,a){this.settings.button_width=d;this.settings.button_height=a;var c=this.getMovieElement();if(c!=undefined){c.style.width=d+"px";c.style.height=a+"px"}this.callFlash("SetButtonDimensions",[d,a])};SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a;this.callFlash("SetButtonText",[a])};SWFUpload.prototype.setButtonTextPadding=function(c,a){this.settings.button_text_top_padding=a;this.settings.button_text_left_padding=c;this.callFlash("SetButtonTextPadding",[c,a])};SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a;this.callFlash("SetButtonTextStyle",[a])};SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a;this.callFlash("SetButtonDisabled",[a])};SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a;this.callFlash("SetButtonAction",[a])};SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a;this.callFlash("SetButtonCursor",[a])};SWFUpload.prototype.queueEvent=function(c,d){if(d==undefined){d=[]}else{if(!(d instanceof Array)){d=[d]}}var a=this;if(typeof this.settings[c]==="function"){this.eventQueue.push(function(){this.settings[c].apply(this,d)});setTimeout(function(){a.executeNextEvent()},0)}else{if(this.settings[c]!==null){throw"Event handler "+c+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var a=this.eventQueue?this.eventQueue.shift():null;if(typeof(a)==="function"){a.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(d){var h=/[$]([0-9a-f]{4})/i;var j={};var f;if(d!=undefined){for(var a in d.post){if(d.post.hasOwnProperty(a)){f=a;var c;while((c=h.exec(f))!==null){f=f.replace(c[0],String.fromCharCode(parseInt("0x"+c[1],16)))}j[f]=d.post[a]}}d.post=j}return d};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(a){return false}};SWFUpload.prototype.flashReady=function(){var a=this.getMovieElement();if(!a){this.debug("Flash called back ready but the flash movie can't be found.");return}this.cleanUp(a);this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(a){try{if(this.movieElement&&typeof(a.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var d in a){try{if(typeof(a[d])==="function"){a[d]=null}}catch(c){}}}}catch(f){}window.__flash__removeCallback=function(h,j){try{if(h){h[j]=null}}catch(k){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("file_queued_handler",a)};SWFUpload.prototype.fileQueueError=function(a,d,c){a=this.unescapeFilePostParams(a);this.queueEvent("file_queue_error_handler",[a,d,c])};SWFUpload.prototype.fileDialogComplete=function(c,d,a){this.queueEvent("file_dialog_complete_handler",[c,d,a])};SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("return_upload_start_handler",a)};SWFUpload.prototype.returnUploadStart=function(a){var c;if(typeof this.settings.upload_start_handler==="function"){a=this.unescapeFilePostParams(a);c=this.settings.upload_start_handler.call(this,a)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(c===undefined){c=true}c=!!c;this.callFlash("ReturnUploadStart",[c])};SWFUpload.prototype.uploadProgress=function(a,d,c){a=this.unescapeFilePostParams(a);this.queueEvent("upload_progress_handler",[a,d,c])};SWFUpload.prototype.uploadError=function(a,d,c){a=this.unescapeFilePostParams(a);this.queueEvent("upload_error_handler",[a,d,c])};SWFUpload.prototype.uploadSuccess=function(c,a,d){c=this.unescapeFilePostParams(c);this.queueEvent("upload_success_handler",[c,a,d])};SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a);this.queueEvent("upload_complete_handler",a)};SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)};SWFUpload.prototype.debugMessage=function(d){if(this.settings.debug){var a,f=[];if(typeof d==="object"&&typeof d.name==="string"&&typeof d.message==="string"){for(var c in d){if(d.hasOwnProperty(c)){f.push(c+": "+d[c])}}a=f.join("\n")||"";f=a.split("\n");a="EXCEPTION: "+f.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(a)}else{SWFUpload.Console.writeLine(d)}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(f){var c,a;try{c=document.getElementById("SWFUpload_Console");if(!c){a=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(a);c=document.createElement("textarea");c.id="SWFUpload_Console";c.style.fontFamily="monospace";c.setAttribute("wrap","off");c.wrap="off";c.style.overflow="auto";c.style.width="700px";c.style.height="350px";c.style.margin="5px";a.appendChild(c)}c.value+=f+"\n";c.scrollTop=c.scrollHeight-c.clientHeight}catch(d){alert("Exception: "+d.name+" Message: "+d.message)}};var SWFUpload;if(typeof(SWFUpload)==="function"){SWFUpload.queue={};SWFUpload.prototype.initSettings=(function(a){return function(){if(typeof(a)==="function"){a.call(this)}this.queueSettings={};this.queueSettings.queue_cancelled_flag=false;this.queueSettings.queue_upload_count=0;this.queueSettings.user_upload_complete_handler=this.settings.upload_complete_handler;this.queueSettings.user_upload_start_handler=this.settings.upload_start_handler;this.settings.upload_complete_handler=SWFUpload.queue.uploadCompleteHandler;this.settings.upload_start_handler=SWFUpload.queue.uploadStartHandler;this.settings.queue_complete_handler=this.settings.queue_complete_handler||null}})(SWFUpload.prototype.initSettings);SWFUpload.prototype.startUpload=function(a){this.queueSettings.queue_cancelled_flag=false;this.callFlash("StartUpload",[a])};SWFUpload.prototype.cancelQueue=function(){this.queueSettings.queue_cancelled_flag=true;this.stopUpload();var a=this.getStats();while(a.files_queued>0){this.cancelUpload();a=this.getStats()}};SWFUpload.queue.uploadStartHandler=function(a){var c;if(typeof(this.queueSettings.user_upload_start_handler)==="function"){c=this.queueSettings.user_upload_start_handler.call(this,a)}c=(c===false)?false:true;this.queueSettings.queue_cancelled_flag=!c;return c};SWFUpload.queue.uploadCompleteHandler=function(c){var d=this.queueSettings.user_upload_complete_handler;var f;if(c.filestatus===SWFUpload.FILE_STATUS.COMPLETE){this.queueSettings.queue_upload_count++}if(typeof(d)==="function"){f=(d.call(this,c)===false)?false:true}else{if(c.filestatus===SWFUpload.FILE_STATUS.QUEUED){f=false}else{f=true}}if(f){var a=this.getStats();if(a.files_queued>0&&this.queueSettings.queue_cancelled_flag===false){this.startUpload()}else{if(this.queueSettings.queue_cancelled_flag===false){this.queueEvent("queue_complete_handler",[this.queueSettings.queue_upload_count]);this.queueSettings.queue_upload_count=0}else{this.queueSettings.queue_cancelled_flag=false;this.queueSettings.queue_upload_count=0}}}}}function FileProgress(d,a){this.fileProgressID=d.id;this.opacity=100;this.height=0;this.uploadBoxId=a||this.uploadBoxId;this.fileProgressWrapper=document.getElementById(this.fileProgressID);if(!this.fileProgressWrapper){this.fileProgressWrapper=document.createElement("div");this.fileProgressWrapper.className="progressWrapper";this.fileProgressWrapper.id=this.fileProgressID;this.fileProgressElement=document.createElement("div");this.fileProgressElement.className="progressContainer";var j=document.createElement("a");j.className="progressCancel";j.href="#";j.style.visibility="hidden";j.appendChild(document.createTextNode(" "));var c=document.createElement("div");c.className="progressName";c.appendChild(document.createTextNode(d.name));var h=document.createElement("div");h.className="progressBarInProgress";var f=document.createElement("div");f.className="progressBarStatus";f.innerHTML="&nbsp;";this.fileProgressElement.appendChild(j);this.fileProgressElement.appendChild(c);this.fileProgressElement.appendChild(f);this.fileProgressElement.appendChild(h);this.fileProgressWrapper.appendChild(this.fileProgressElement);document.getElementById(a).appendChild(this.fileProgressWrapper);this.setUploadBoxHeight(document.getElementById(a))}else{this.fileProgressElement=this.fileProgressWrapper.firstChild;this.reset()}this.height=this.fileProgressWrapper.offsetHeight;this.setTimer(null)}var SWF_UPLOAD_BOX_HEIGHT=SWF_UPLOAD_BOX_HEIGHT||null;FileProgress.prototype.setUploadBoxHeight=function(f){if("object"!=typeof f){return}var c=document.body.scrollHeight;var d=f.offsetHeight;var a=250;c=c-a;if(d>c&&f.style.height==""){f.style.height=c+"px";f.style.overflow="auto";SWF_UPLOAD_BOX_HEIGHT=c}};FileProgress.prototype.resetUploadBoxHeight=function(a){if("object"!=typeof a){return}if(a.style.height&&a.style.height!=""&&a.scrollHeight<=SWF_UPLOAD_BOX_HEIGHT+50){a.style.height="";a.style.overflow=""}this.finishedUpload(a.offsetHeight)};FileProgress.prototype.finishedUpload=function(c){var a=SWFUpload.CONST.PROGRESS_TARGET_HEIGHT;if(a==c){window.setTimeout("UploadAction.hideUploadArea()",1000)}};FileProgress.prototype.setTimer=function(a){this.fileProgressElement.FP_TIMER=a};FileProgress.prototype.getTimer=function(a){return this.fileProgressElement.FP_TIMER||null};FileProgress.prototype.reset=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[2].innerHTML="&nbsp;";this.fileProgressElement.childNodes[2].className="progressBarStatus";this.fileProgressElement.childNodes[3].className="progressBarInProgress";this.fileProgressElement.childNodes[3].style.width="0%";this.appear()};FileProgress.prototype.setProgress=function(a){this.fileProgressElement.className="progressContainer green";this.fileProgressElement.childNodes[3].className="progressBarInProgress";this.fileProgressElement.childNodes[3].style.width=a+"%";this.appear()};FileProgress.prototype.setComplete=function(){this.fileProgressElement.className="progressContainer blue";this.fileProgressElement.childNodes[3].className="progressBarComplete";this.fileProgressElement.childNodes[3].style.width="";var a=this;this.setTimer(setTimeout(function(){a.disappear()},2000))};FileProgress.prototype.setError=function(){this.fileProgressElement.className="progressContainer red";this.fileProgressElement.childNodes[3].className="progressBarError";this.fileProgressElement.childNodes[3].style.width="";var a=this;this.setTimer(setTimeout(function(){a.disappear()},5000))};FileProgress.prototype.setCancelled=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[3].className="progressBarError";this.fileProgressElement.childNodes[3].style.width="";var a=this;this.setTimer(setTimeout(function(){a.disappear()},2000))};FileProgress.prototype.setStatus=function(a){this.fileProgressElement.childNodes[2].innerHTML=a};FileProgress.prototype.toggleCancel=function(c,d){this.fileProgressElement.childNodes[0].style.visibility=c?"visible":"hidden";if(d){var a=this.fileProgressID;this.fileProgressElement.childNodes[0].onclick=function(){d.cancelUpload(a);return false}}};FileProgress.prototype.appear=function(){if(this.getTimer()!==null){clearTimeout(this.getTimer());this.setTimer(null)}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100}catch(a){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)"}}else{this.fileProgressWrapper.style.opacity=1}this.fileProgressWrapper.style.height="";this.height=this.fileProgressWrapper.offsetHeight;this.opacity=100;this.fileProgressWrapper.style.display=""};FileProgress.prototype.disappear=function(){var h=15;var d=4;var c=10;if(this.opacity>0){this.opacity-=h;if(this.opacity<0){this.opacity=0}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=this.opacity}catch(f){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+this.opacity+")"}}else{this.fileProgressWrapper.style.opacity=this.opacity/100}}if(this.height>0){this.height-=d;if(this.height<0){this.height=0}this.fileProgressWrapper.style.height=this.height+"px"}if(this.height>0||this.opacity>0){var a=this;this.setTimer(setTimeout(function(){a.disappear()},c))}else{this.fileProgressWrapper.style.display="none";this.setTimer(null);this.resetUploadBoxHeight(document.getElementById(this.uploadBoxId))}};function fileQueued(d){try{var a=new FileProgress(d,this.customSettings.progressTarget);a.setStatus("Pending...");a.toggleCancel(true,this)}catch(c){this.debug(c)}}function fileQueueError(d,h,f){try{if(h===SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){alert("You have attempted to queue too many files.\n"+(f===0?"You have reached the upload limit.":"You may select "+(f>1?"up to "+f+" files.":"one file.")));return}var a=new FileProgress(d,this.customSettings.progressTarget);a.setError();a.toggleCancel(false);switch(h){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:a.setStatus("File is too big.");this.debug("Error Code: File too big, File name: "+d.name+", File size: "+d.size+", Message: "+f);break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:a.setStatus("Cannot upload Zero Byte files.");this.debug("Error Code: Zero byte file, File name: "+d.name+", File size: "+d.size+", Message: "+f);break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:a.setStatus("Invalid File Type.");this.debug("Error Code: Invalid File Type, File name: "+d.name+", File size: "+d.size+", Message: "+f);break;default:if(d!==null){a.setStatus("Unhandled Error")}this.debug("Error Code: "+h+", File name: "+d.name+", File size: "+d.size+", Message: "+f);break}}catch(c){this.debug(c)}}function fileDialogComplete(a,d){try{if("undefined"!=typeof UploadAction){UploadAction.setSWFUploadPath()}if(a>0){document.getElementById(this.customSettings.cancelButtonId).disabled=false}showHideQueueBox.call(this,"block");this.startUpload()}catch(c){this.debug(c)}}function showHideQueueBox(c){var d=this.customSettings.queueBox?this.customSettings.queueBox:null;if(d&&document.getElementById(d)){var a=document.getElementById("QueueBox");a.style.display=c}}function uploadStart(d){try{var a=new FileProgress(d,this.customSettings.progressTarget);a.setStatus("Uploading...");a.toggleCancel(true,this)}catch(c){}return true}function uploadProgress(d,j,h){try{var f=Math.ceil((j/h)*100);var a=new FileProgress(d,this.customSettings.progressTarget);a.setProgress(f);a.setStatus("Uploading...")}catch(c){this.debug(c)}}function uploadSuccess(h,d){try{var c=new FileProgress(h,this.customSettings.progressTarget);c.setComplete();c.setStatus("Complete.");c.toggleCancel(false);var a=this;setTimeout(function(){showHideQueueBox.call(a,"none")},3000)}catch(f){this.debug(f)}}function uploadError(d,h,f){try{var a=new FileProgress(d,this.customSettings.progressTarget);a.setError();a.toggleCancel(false);switch(h){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:a.setStatus("Upload Error: "+f);this.debug("Error Code: HTTP Error, File name: "+d.name+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:a.setStatus("Upload Failed.");this.debug("Error Code: Upload Failed, File name: "+d.name+", File size: "+d.size+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:a.setStatus("Server (IO) Error");this.debug("Error Code: IO Error, File name: "+d.name+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:a.setStatus("Security Error");this.debug("Error Code: Security Error, File name: "+d.name+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:a.setStatus("Upload limit exceeded.");this.debug("Error Code: Upload Limit Exceeded, File name: "+d.name+", File size: "+d.size+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:a.setStatus("Failed Validation.  Upload skipped.");this.debug("Error Code: File Validation Failed, File name: "+d.name+", File size: "+d.size+", Message: "+f);break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:if(this.getStats().files_queued===0){document.getElementById(this.customSettings.cancelButtonId).disabled=true}a.setStatus("Cancelled");a.setCancelled();break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:a.setStatus("Stopped");break;default:a.setStatus("Unhandled Error: "+h);this.debug("Error Code: "+h+", File name: "+d.name+", File size: "+d.size+", Message: "+f);break}}catch(c){this.debug(c)}}function uploadComplete(a){if(this.getStats&&this.getStats().files_queued===0){document.getElementById(this.customSettings.cancelButtonId).disabled=true}}function queueComplete(c){var a=document.getElementById("divStatus");a.innerHTML="上传了"+c+"个文件";if("undefined"!=typeof DirAction){DirAction.getDirJSON(UPLOAD.uploadPath)}}var HTMLTemplate={createNewFolderHTML:'<div class="create-newfolder" id="CreateNewFolder"><form action="file" method="get" target="" onsubmit="return FileAction.createFolder(UPLOAD.uploadPath, this.name.value);" target="_blank">名称:&nbsp;&nbsp;<input type="text" size="30" name="name" id="NewFolderName"/><br/><div class="tips" id="CreateNewFolerTips"></div><input type="submit" value="提交" />&nbsp;&nbsp;<a href="javascript:FileAction.hideCreateFolder();" id="CreateNewFolderCancelButton" class="close-button">关闭</a></form></div>',uploadHTML:'<div class="upload-area" id="UploadArea">上传路径：<span id="UploadPathTips"></span>	<div class="fieldset flash" id="fsUploadProgress">			<span class="legend">文件队列</span>	</div>		<span id="divStatus">&nbsp;</span>	<div>		<span id="spanButtonPlaceHolder"></span>		<input id="btnCancel" type="file" multiple="multiple" value="选择文件" onchange="UploadAction.uploadStart(this.files);" />		&nbsp;<a href="javascript:UploadAction.hideUploadArea();" class="close-button" style="float:right;margin-right:5px;">关闭</a>	</div></div>',editHTML:'<span><a href="javascript:FileAction.deleteFile(FileAction.tableListTr)" class="edit-delete" title="删除">&nbsp;</a></span><span><a href="javascript:FileAction.setRenameArea(FileAction.tableListTr)" class="edit-rename" title="重命名">&nbsp;</a></span><span><a href="javascript:FileAction.copyFile(FileAction.tableListTr)" class="edit-copy" title="复制">&nbsp;</a></span>',renameHTML:'<input id="Rename" value="" size="30" /><span><a href="javascript:FileAction.renameFile(FileAction.tableListTr, g(\'Rename\').value)">确定</a></span><span><a href="javascript:FileAction.hideRenameArea()">取消</a></span>',helpHTML:'<div id="HelpContent" class="help-content"></div><div class="help-close"><a href="javascript:HelpAction.close()">关闭</a></div>'};var global={DIR_ROOT:"",DIR_PATH:"dir",FILE_PATH:"file",UPLOAD_PATH:"upload",FIEL_WEB_ROOT_URL:"http://www.website.com/",DOC_WEB_ROOT_URL:"http://www.website.com/ReadWord",FA_LOGIN_URL:"login",OPEN_FILE_REDIRECT:false,OPEN_FOLDER_UPDATE_TREE:true,OPEN_FOLDER_NEW_WINDOW:false};var getExt=function(a){if(a&&a.length>0){var c;var d=a.lastIndexOf(".");if(d!=-1){c=a.substr(d+1)}else{c=""}}return c};var OFFICE_FILE_EXT=["doc","ppt","xls","docx","pptx","xlsx"];var isOfficeFile=function(c){if(c!=null&&c.length>0){var a=array.indexOf(OFFICE_FILE_EXT,c.toLowerCase());if(a!=-1){return true}}return false};var getFolderIconCss=function(){return"folder"};var getFileIconCss=function(a){if(a=="folder"){return"folder"}a=a.toLowerCase();switch(a){case"doc":ext="doc";break;case"docx":ext="doc";break;case"xls":ext="xls";break;case"xlsx":ext="xls";break;case"ppt":ext="ppt";break;case"pptx":ext="ppt";break;case"pdf":ext="pdf";break;case"txt":ext="txt";break;case"exe":ext="exe";break;case"html":ext="html";break;case"htm":ext="html";break;case"css":ext="css";break;case"js":ext="js";break;case"swf":ext="swf";break;case"fla":ext="swf";break;case"zip":ext="zip";break;case"rar":ext="rar";break;case"gz":ext="rar";break;case"tar":ext="rar";break;case"gif":ext="gif";break;case"png":ext="png";break;case"jpg":ext="jpg";break;case"mp3":ext="mp3";break;case"wma":ext="mp3";break;case"wav":ext="mp3";break;case"rm":ext="rm";break;default:ext="file"}return ext};var decodeHTML=function(a){if(!a||a.length<=0){return a}a=a.replace(/&amp;/g,"&");a=a.replace(/&#039;/g,"'");a=a.replace(/&quot;/g,'"');a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");return a};var encodeURLCharForFlash=function(a){a=a.replace(/&/g,"&amp;");return a};var decodeSpecial=function(a){if(!a||a.length<=0){return a}a=a.replace(/&/g,"&amp;");a=a.replace(/'/g,"&#039;");a=a.replace(/"/g,"&quot;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a};var getSlash=function(c){if(c===null||c===undefined||c.length<=0){return c}var a=c.substring(c.length-1);if(a=="/"||a=="\\"){return""}return"/"};var removeLastSlash=function(c){if(c==null||c.length<=1){return c}var a=c.substring(c.length-1);if(a=="/"||a=="\\"){return c.substr(0,c.length-1)}return c};var getParentPath=function(d){if(d==null||d.length<=0){return d}var c=d;c=removeLastSlash(c);c=replaceSlash(c);var a=c.lastIndexOf("/");if(a!=-1){return c.substr(0,a+1)}return d};var encodeJS=function(a){a=a.replace(/'/g,"'");a=a.replace(/"/g,'"');return a};var encodeforJS=function(a){a=a.replace(/'/g,"\\'");a=a.replace(/"/g,'\\"');return a};var SPECIAL_CHAR=["\\","/",":","*","?",'"',"<",">","|"];var isAvailableName=function(a){if(a==null||a.length<0){return false}var c=/[\\\/:*?\"<>|]+/g;return !c.test(a)};var replaceSlash=function(a){if(a==null||a.length<=0){return a}a=a.replace(/\\/g,"/");return a};var encodeURL=function(k){if(k==null||k.length<=0){return k}var f=k;var j="http://";var c=false;if(k.substr(0,7)==j){c=true;k=(k.substr(7))}if(k.indexOf("\\")!=-1){k=replaceSlash(k)}if(k.indexOf("/")!=-1){var d=[];d=k.split("/");var a=d.length;for(var h=0;h<a;h++){d[h]=encodeURIComponent(d[h])}f=d.join("/");if(c){f=j+d.join("/")}return f}return encodeURIComponent(f)};var createTemplateHTMLContainer=function(){if(!g("TemplateHTMLContainer")){var a=document.createElement("div");a.id="TemplateHTMLContainer";document.body.appendChild(a)}};var getTemplateHTMLContainer=function(){if(g("TemplateHTMLContainer")){return g("TemplateHTMLContainer")}else{createTemplateHTMLContainer();return g("TemplateHTMLContainer")}};var toggleMask=function(f,c){var a=(f&&typeof f=="object")?f:g("mask");if(c!=null&&c.length>0){a.style.display=c}else{var d=(a.style.display==""||a.style.display=="none");a.style.display=d?"block":"none"}};function hasError(){this.showTips=function(c){var f=[];var a=0;for(var d in c){f.push(c[d]+"\r\n");a++}if(a>0){alert(f.join(""));c={};gotoUrl();return true}return false};this.gotoUrl=function(){window.location.replace(global.FA_LOGIN_URL)};return showTips(ErrorMessage)}var UploadActoin=UploadActoin||{};var DirAction=DirAction||{};var FileAction=FileAction||{};var UploadAction=UploadAction||{};var HelpAction=HelpAction||{};var ErrorMessage=ErrorMessage||{};var MESSAGE=MESSAGE||{};var DIR=DIR||{};var FILE=FILE||{};var UPLOAD=UPLOAD||{};UPLOAD.uploadPath=UPLOAD.uploadPath||"";var Tree=Tree||{};var SWFUP=SWFUP||{};function Upload(){}Upload.prototype={customSettings:{progressTarget:"fsUploadProgress",cancelButtonId:"btnCancel"},setSWFUploadPath:function(c){var c=c||UPLOAD.uploadPath;if(SWFUP&&"function"==typeof SWFUP.setPostParams){try{SWFUP.setPostParams({path:c})}catch(a){alert(a.toString())}}},SWFUPsetting:function(){var a={flash_url:"swf/swfupload.swf",upload_url:global.UPLOAD_PATH,file_post_name:"uploads",post_params:{path:(UPLOAD.uploadPath)},file_size_limit:"1024 MB",file_types:"*.*",file_types_description:"All Files",file_upload_limit:100,file_queue_limit:0,custom_settings:{progressTarget:"fsUploadProgress",cancelButtonId:"btnCancel"},debug:false,button_image_url:"img/upload-button.png",button_width:"90",button_height:"24",button_placeholder_id:"spanButtonPlaceHolder",file_queued_handler:fileQueued,file_queue_error_handler:fileQueueError,file_dialog_complete_handler:fileDialogComplete,upload_start_handler:uploadStart,upload_progress_handler:uploadProgress,upload_error_handler:uploadError,upload_success_handler:uploadSuccess,upload_complete_handler:uploadComplete,queue_complete_handler:queueComplete};SWFUP=new SWFUpload(a)},setPosition:function(d,c,a){if(!d){return}d.style.left=c+"px";d.style.top=a+"px"},setUploadHTML:function(){if(!g("UploadArea")){try{var d=HTMLTemplate.uploadHTML;var a=getTemplateHTMLContainer();var f=document.createElement("div");f.innerHTML=d;a.appendChild(f)}catch(c){alert(c.toString())}}},request:function(d,c){var f=new XMLHttpRequest();c=c||{};var a=this;f.addEventListener("loadstart",c.onstart);f.upload.addEventListener("progress",c.onprogress);f.addEventListener("error",c.onerror);f.onreadystatechange=function(h){console.log("onreadystatechange:",f,f.responseText,h);if(f.readyState===4){if(f.status===200){c.onsuccess.call(a,f)}else{c.onfail.call(a,f)}}};f.open("post","./upload");f.send(d);return f},startUpload:function(j){var c=this;var k=j.length;var h=k;for(var f=0,a=j.length;f<a;f++){var d=j[f];d.id="fileupload_"+f;var m=new FormData();m.append("path",UPLOAD.uploadPath);m.append("uploads",d);fileQueued.call(c,d);(function(l,n){l.request(m,{onstart:function(o){console.log("uopload.class->startUpload:onstart:",n)},onsuccess:function(o){uploadSuccess.call(l,n,o);uploadComplete.call(l,n);console.log(n.name+"uopload.class->startUpload:onsuccess:",n.name);h-=1;if(h===0){queueComplete.call(l,k)}},onfail:function(o){console.log("uopload.class->startUpload:onfail:",o)},onprogress:function(o){console.log("uopload.class->startUpload:onprogress:",o.loaded,o.total,n.size);uploadProgress.call(l,n,o.loaded,o.total)}})})(c,d)}}};Upload.prototype.constructor=Upload;UploadAction=(function(){var h="";var d=new Upload();var k=function(n){d.setSWFUploadPath(n)};var j=function(n){n=n+getSlash(n);UPLOAD.uploadPath=decodeHTML(n)};var c=function(){g("UploadArea").style.display="none";toggleMask(null,"none")};var l=function(){d.setUploadHTML();if(!g("UploadArea")){return}var p=g("UploadArea");if(p.style.display==""){var o=dom.getPosition(this).left;var n=dom.getPosition(this).top;d.setPosition(p,o,n+20)}a(p);g("UploadPathTips").innerHTML=UPLOAD.uploadPath;g("divStatus").innerHTML="";toggleMask()};var a=function(o){if("object"!=typeof o){return}var n=((o.style.display==""||o.style.display=="none"));o.style.display=n?"block":"none"};var f=function(n){d.startUpload(n,function(o){console.log("UploadAction.response:",o)})};var m=function(){Youngli.on(g("UploadFileLink"),"onclick",UploadAction.setUploadHTML)};return{init:m,setUploadPath:j,setUploadHTML:l,hideUploadArea:c,setSWFUploadPath:k,uploadStart:f}})();UploadAction.init();function Directory(a){this.DIR=a?a:window.DIR;this.html=[];this.FileList=this.FileList?this.FileList:g("FileList");this.FileListContent=this.FileListContent?this.FileListContent:g("FileListContent");this.FileListTitle=this.FileListTitle?this.FileListTitle:g("FileListTitle");this.DirList=this.DirList?this.DirList:g("DirList");this.InfoPanel=this.InfoPanel?this.InfoPanel:g("InfoPanel")}Directory.prototype._setHTML=function(a){this.html=a};Directory.prototype._getHTML=function(){return this.html};Directory.prototype.listDirTree=function(){function a(d,c){DirAction.getDirJSON(d)}Tree=new dhtmlXTreeObject("DirList","100%","100%",0);Tree.parentObject.style.overflow="auto";Tree.setSkin("dhx_skyblue");Tree.enableHighlighting(1);Tree.setImagePath("img/tree/");Tree.enableDragAndDrop(0);Tree.enableTreeLines(false);Tree.setEscapingMode("utf8");Tree.setImageArrays("plus",null,null,null,"plus_ar.gif");Tree.setImageArrays("minus",null,null,null,"minus_ar.gif");Tree.setStdImages("folderClosed.gif","folderOpen.gif","folderClosed.gif");Tree.setXMLAutoLoading("dir!getTree.action");Tree.setOnClickHandler(a);Tree.loadXML("dir!getTree.action",function(){})};Directory.prototype.getFileAndFolderTheadHTML=function(){return'<table class="file-table-head"><colgroup><col class="table-name"/><col class="table-size"/><col class="table-modified-date"/><col class="table-type"/><col class="table-blank"/></colgroup><tr><th>名称</th><th>大小</th><th>修改日期</th><th>类型</th><th>&nbsp;</th></tr></table>'};Directory.prototype.getFileAndFolderListHTML=function(a){var o=a?a:this.DIR;var p=a.path?a.path:a.absolutePath;UploadAction.setUploadPath(p);var k=[];if(o){var n=o.FilesList;var q=0;var c=target=ext="",d="#",m="";function l(){return'<colgroup><col class="table-name"/><col class="table-size"/><col class="table-modified-date"/><col class="table-type"/><col class="table-blank"/></colgroup>'}function h(r){return""+getFileIconCss(r)}function j(v){var u=v?v:null;if(u==null){return""}var s=u.name;var y=o.relationPath+getSlash(o.relationPath);var t=getExt(s);var B=h(t);var w="";var z="&nbsp;";var r="#";var x="";if(u.type=="folder"){var A="";if(!global.OPEN_FOLDER_NEW_WINDOW){x="";A=decodeHTML(p)+getSlash(p)+decodeHTML(s);r="javascript:DirAction.openFolder('"+encodeforJS(A)+"');"}z="folder";B=getFolderIconCss()}if(u.type!="folder"){r="#";if(global.FIEL_WEB_ROOT_URL){var A=decodeHTML(y)+decodeHTML(s);r=global.FIEL_WEB_ROOT_URL+encodeURL(A);if(global.OPEN_FILE_REDIRECT){r="redir?url="+r}}if(isOfficeFile(t)&&global.DOC_WEB_ROOT_URL){r=global.DOC_WEB_ROOT_URL+"?file="+encodeURIComponent(decodeHTML(o.absolutePath))+encodeURIComponent(decodeHTML(s))}x="_blank";z=t}w=('<a href="'+r+'" class="'+B+'" target="'+x+'">'+s+"</a>");return"<tr><td>"+w+"</td><td>"+v.length+"</td><td>"+v.date+"</td><td>"+z+"</td><td>&nbsp;</td></tr>"}k.push('<table class="file-table-list" id="FileTableList">');k.push(l());for(var f in n){q++;f=n[f];k.push(j(f))}k.push("</table>")}this._setHTML(k);return k.join("")};Directory.prototype.getFileListHTML=function(d){var c=d?d:this.DIR;var k=[];if(c){var l=c.Files;var a=l.nameList.length;var h,f,j;for(j=0;j<a;j++){h=l.nameList[j];f=global.FILE_PATH+"?path="+encodeURIComponent(h);k.push('<a href="'+f+'">'+h+"</a><br/>")}}this._setHTML(k);return k.join("")};Directory.prototype.getInfoPanelHTML=function(d){var c=d?d:this.DIR;var j=[];if(c&&c.Folders&&c.Files){var h=c.Folders.nameList.length;var f=c.Files.nameList.length;var a=h+f;j.push("<dl><dt>共:  "+a+" 个项目</dt>");j.push("<dd>文件夹: "+h+" 个");j.push(" , 文件: "+f+" 个</dd></dl>");j.push('<dl class="hard-size"><dt>硬盘大小:  '+c.hardPartition.totalSpace+" </dt>");j.push("<dd>已用空间: "+c.hardPartition.useableSpace+" ");j.push(" , 还剩: "+c.hardPartition.freeSpace+" </dd></dl>")}this._setHTML(j);return j.join("")};Directory.prototype.setDirAndFileList=function(c){if(hasError()){return false}var a=c?c:this.DIR;this.listDirTree();this.setFileAndFolderList(a)};Directory.prototype.setDirList=function(a){this.DirList.innerHTML=this.getDirListHTML(a)};Directory.prototype.setFileAndFolderList=function(a){if(hasError()){return false}this.FileListTitle.innerHTML=this.getFileAndFolderTheadHTML(a);this.FileListContent.innerHTML=this.getFileAndFolderListHTML(a);if(browser.ie==6){DirAction.setPageHeight()}};Directory.prototype.setFileList=function(a){this.FileList.innerHTML=this.getFileListHTML(a)};Directory.prototype.setInfoPanel=function(a){this.InfoPanel.innerHTML=this.getInfoPanelHTML(a)};DirAction=function(){var dirClass=new Directory();var page=g("Page");var DIR=dirClass.DIR;var dirPath=global.DIR_PATH;var FileListContent=dirClass.FileListContent;var DirList=dirClass.DirList;var FileList=dirClass.FileList;var dragBar=dragBar||g("DragBar");var setPageHeight=function(){var h=document.body.offsetHeight;h=h>200?h:200;var height=h-180;if(browser.ie<=6){height=h-200}dom.setStyle(FileListContent,"height",height);dom.setStyle(DirList,"height",height+41);dom.setStyle(dragBar,"height",height+41)};function dragColumn(){if("undefined"==typeof dragBar){return}var dragSide=new Drag();dragSide.obj=dragBar;dragSide.range={minX:50,minY:dom.getPosition(dragBar).top,maxX:document.body.offsetWidth-200,maxY:dom.getPosition(dragBar).top+dragBar.offsetHeight};var DirList=DirList||g("DirList");var FileList=FileList||g("FileList");var process=0;dragSide.onmousemove=function(){var ex=dragSide.mousePosition.x;var ey=dragSide.mousePosition.y;process=this.position.left-this.range.minX;var DirListWidth=DirList.offsetWidth;var marginLeft=parseInt(FileList.style.paddingLeft);DirList.style.width=process+55+"px";FileList.style.marginLeft=process-162+"px"};dragSide.onmousestop=function(){Youngli.cookie.set("dragColumn.process",process,{path:"",expires:60*60*24*365,domain:"",secure:""})};dragSide.init()}var setDragColumnProcess=function(){var process=Youngli.cookie.get("dragColumn.process");if(process){var process=parseInt(process);dragBar.style.left=process+50+"px";FileList.style.marginLeft=process-162+"px";DirList.style.width=process+55+"px"}};var pageInit=function(){setDragColumnProcess();getDirJSON("");dirClass.setDirAndFileList();setPageHeight();console.log("page init.")};var getDirJSON=function(path){var url=dirPath+"?path="+encodeURIComponent(path);var xhr=ajax.get(url,_parseDirJSON);if(FileAction&&FileAction.hideFileEditBar){FileAction.hideFileEditBar()}};var _parseDirJSON=function(xhr,responseText){eval(responseText);dirClass.setFileAndFolderList(DIR);dirClass.setInfoPanel(DIR);FileAction.initTableListRowEvent()};var openFolder=function(path){if(global.OPEN_FOLDER_UPDATE_TREE){var id=decodeHTML(path)+getSlash(path);var sn=(new Date()).valueOf();var parentPath=getParentPath(id);var dirUrl="dir!getTree.action?id="+id;dirUrl=dirUrl+"&uid="+sn;if(Tree.getOpenState(parentPath)!=1&&Tree.getOpenState(id)!=1){Tree.openItem(parentPath);window.setTimeout(function(){Tree.selectItem(id)},100)}else{Tree.selectItem(id)}}getDirJSON(path)};return{pageInit:pageInit,setPageHeight:setPageHeight,getDirJSON:getDirJSON,openFolder:openFolder,dragColumn:dragColumn}}();if(!this.FA_JS_ASYNC_LOAD){DirAction.pageInit()}Youngli.on(window,"onresize",DirAction.setPageHeight);Youngli.on(window,"onload",DirAction.dragColumn);function File(){this.path="";this.relationPath="";this.absolutePath="";this.filePath=global.FILE_PATH}File.prototype={setCreateFolderHTML:function(){if(!g("CreateNewFolder")){try{var d=HTMLTemplate.createNewFolderHTML;var a=getTemplateHTMLContainer();var f=document.createElement("div");f.innerHTML=d;a.appendChild(f)}catch(c){alert(c.toString())}}},getFolderJSON:function(f,c){try{var f=f+getSlash(f);f=decodeHTML(f);var a=this.filePath+"?mkdir=yes&path="+encodeURIComponent(f)+"&name="+encodeURIComponent(c);var h=ajax.get(a,FileAction.parseFolderJSON)}catch(d){alert(d.toString())}},setPosition:function(d,c,a){if(!d){return}d.style.left=c+"px";d.style.top=a+"px"},insertRow:function(a){if(hasError()){return false}DirAction.getDirJSON(decodeHTML(UPLOAD.uploadPath))},setFileEditHTML:function(){try{if(!g("FileEditBar")){var c=HTMLTemplate.editHTML;var d=document.createElement("div");d.id="FileEditBar";d.innerHTML=c;document.body.appendChild(d);d.className="file-edit-bar"}}catch(a){alert(a.toString())}},setRenameArea:function(){try{if(!g("FileRenameArea")||null==g("FileRenameArea")){var c=HTMLTemplate.renameHTML;var d=document.createElement("div");d.id="FileRenameArea";d.innerHTML=c;d.className="file-rename-area";document.body.appendChild(d)}}catch(a){alert(a.toString())}},renameFile:function(h,j){if(typeof h!="object"||j==null){return}if(trim(j).length==""){alert("请输入名称");return}if(!isAvailableName(j)){alert("名字不能含有:"+SPECIAL_CHAR.join(", ")+" 字符");return}var d=h.cells[0];var a="";if(!d||!d.firstChild){return}a=d.firstChild.innerHTML;if(a!=j){try{var k=h.cells[3].innerHTML;var m=(UPLOAD.uploadPath+decodeHTML(a));var c=global.FILE_PATH+"!rename.action?path="+encodeURIComponent(m)+"&name="+encodeURIComponent(j);var l=ajax.get(c,FileAction.parseRenameJSON)}catch(f){alert(f.toString())}}},copyFile:function(f){if(typeof f!="object"){return}try{var j=f.cells[0];var c="";if(!j||!j.firstChild){return}c=j.firstChild.innerHTML;var h=(UPLOAD.uploadPath+decodeHTML(c));var a=global.FILE_PATH+"!copy.action?path="+encodeURIComponent(h);var k=ajax.get(a,FileAction.parseCopyJSON)}catch(d){alert(d.toString())}},deleteFile:function(j){if(typeof j!="object"){return}try{var f=j.cells[0];var a="";if(!f||!f.firstChild){return}a=f.firstChild.innerHTML;var k=j.cells[3].innerHTML;var m=(UPLOAD.uploadPath+decodeHTML(a));var d=k=="folder"?"您确定要删除 "+a+" 文件夹吗？\r\n其全部子文件夹和文件将一同被删除。":"您确定要删除 "+a+" 文件吗？";if(confirm(d)){var c=global.FILE_PATH+"!delete.action?path="+encodeURIComponent(m);var l=ajax.get(c,FileAction.parseDeleteJSON);g("FileEditBar").style.display="none";setTimeout("FileAction.hideFileEditBar()",1)}}catch(h){alert(h.toString())}},_getFolderTr:function(c){var d="",j="_blank",a="";var h=this.relationPath||DIR.relationPath;var f=getFolderIconCss();if(global.FIEL_WEB_ROOT_URL){a=global.FIEL_WEB_ROOT_URL+encodeURIComponent(decodeHTML(h))+getSlash(h)+encodeURIComponent(decodeHTML(c.name))}nameLink=('<a href="'+a+'" class="'+f+'" target="'+j+'">'+c.name+"</a>");d+="<tr><td>"+nameLink+"</td><td>"+c.length+"</td><td>"+c.date+"</td><td>"+c.type+"</td><td>&nbsp;</td></tr>";return(d)}};var isDeleting=isDeleting||"null";FileAction=(function(){var fileClass=new File();var filePath=global.FILE_PATH;var tableListTr;var tableListTrIndex;var isEditing=false;var init=function(){Youngli.on(g("CreateNewFolderLink"),"onclick",FileAction.setCreateFolderHTML);Youngli.on(g("FileListContent"),"onscroll",function(){_hideFileEditBar();_hideRenameArea();removeBgColor(FileAction.tableListTr)})};var outFileListContent=function(e){e=window.event||e;var x,y;if(!document.all){x=e.clientX;y=e.clientY}else{x=e.x;y=e.y}if(!_isInFileTableList(x,y)){_hideFileEditBar();_hideRenameArea()}};var _isInFileTableList=function(x,y){if(!x||!y||x<=0||y<=0){return false}var top=dom.getPosition(g("FileTableList")).top;var left=dom.getPosition(g("FileTableList")).left;var width=g("FileTableList").offsetWidth;var bottom=dom.getPosition(g("InfoPanel")).top;var right=left+width;if((x<left||x>right)||(y<top||y>bottom)){return false}else{return true}};var hideCreateFolder=function(){if(g("CreateNewFolder")){_hide(g("CreateNewFolder"))}toggleMask()};var setCreateFolderHTML=function(){fileClass.setCreateFolderHTML();if(g("CreateNewFolder")){try{var left=dom.getPosition(this).left;var top=dom.getPosition(this).top+20;fileClass.setPosition(g("CreateNewFolder"),left,top);_showOrHide(g("CreateNewFolder"));_setNewFolderNameInputStatus();toggleMask()}catch(ex){alert(ex.toString())}}};var _setNewFolderNameInputStatus=function(){if(g("CreateNewFolder").style.display!="none"&&g("NewFolderName")){g("NewFolderName").focus();if(g("NewFolderName").value==""){_setTips(null,"")}}};var _setTips=function(id,str){var obj=g(id)||g("CreateNewFolerTips");obj.innerHTML=str;g("NewFolderName").focus()};var initTableListRowEvent=function(){var tableList=g("FileTableList");var len=tableList.rows.length;for(var i=0;i<len;i++){var obj={};obj.tr=tableList.rows[i];Youngli.on(tableList.rows[i],"onmouseover",FileAction.setTrOver,obj);Youngli.on(tableList.rows[i],"onmouseout",FileAction.setTrOut)}};var addBgColor=function(trObj,color){if(!trObj||"object"!=typeof trObj){return}color=color||"#edf7fd";trObj.style.backgroundColor=color};var removeBgColor=function(trObj){if(!trObj||"object"!=typeof trObj){return}trObj.style.backgroundColor=""};var setTrOver=function(obj){if(isEditing){return}var trObj=(typeof(obj.tagName)=="string")?obj:this.tr;addBgColor(trObj);setFileEditHTML(trObj)};var setFileEditHTML=function(trObj){FileAction.tableListTrIndex=(_getTableListTrIndex(trObj));FileAction.tableListTr=trObj;fileClass.setFileEditHTML();try{g("FileEditBar").onmouseover=function(){addBgColor(trObj);_showFileEditBar()};g("FileEditBar").onmouseout=function(){if(!isEditing){removeBgColor(trObj)}_hideFileEditBar()};var left=dom.getPosition(trObj).left;var top=dom.getPosition(trObj).top;var fileNameWidth=trObj.cells[0].firstChild.offsetWidth;left+=browser.ie?fileNameWidth+8:fileNameWidth+5;fileClass.setPosition(g("FileEditBar"),left,top);_showFileEditBar()}catch(ex){alert(ex.toString())}};var setTrOut=function(obj){if(isEditing){return}var trObj=(typeof(obj.tagName)=="string")?obj:this;removeBgColor(trObj);_hideFileEditBar()};var setRenameArea=function(trObj){fileClass.setRenameArea();try{if(g("FileRenameArea")&&trObj.cells[0]){var fileNameWidth=trObj.cells[0].firstChild.offsetWidth;var left=dom.getPosition(g("FileEditBar")).left-fileNameWidth+18;var top=dom.getPosition(g("FileEditBar")).top;fileClass.setPosition(g("FileRenameArea"),left,top);g("FileRenameArea").style.width=trObj.offsetWidth-45+"px";var mouseoverFileRenameArea=0;Youngli.on(g("FileRenameArea"),"onmouseout",function(){mouseoverFileRenameArea=0});Youngli.on(g("FileRenameArea"),"onmouseover",function(){mouseoverFileRenameArea=1;_showRenameArea()});Youngli.on(document,"onclick",function(){if(mouseoverFileRenameArea!=1){_hideRenameArea();removeBgColor(trObj)}});if(g("Rename")!=null){g("Rename").value=decodeHTML(trObj.cells[0].firstChild.innerHTML);g("Rename").style.width=fileNameWidth+"px";g("Rename").onkeyup=function(e){e=window.event||e;if(e.keyCode==13){renameFile(trObj,this.value)}}}addBgColor(trObj);_showRenameArea()}}catch(ex){alert(ex.toString())}};var _getTableListTrIndex=function(trObj,table){var table=table||g("FileTableList");var len=table.rows.length;for(var i=0;i<len;i++){if(table.rows[i]==trObj){return i}}return -1};var _getTableTrByIndex=function(index,table){var table=table||g("FileTableList");if(table.rows[index]){return table.rows[index]}return null};var renameFile=function(trObj,newName){fileClass.renameFile(trObj,newName);_hideRenameArea()};var _refreshDirTree=function(){try{var state=Tree.getOpenState(UPLOAD.uploadPath);Tree.refreshItem(decodeHTML(UPLOAD.uploadPath));if(state!=1){Tree.closeItem(UPLOAD.uploadPath);window.setTimeout(function(){Tree.closeItem(UPLOAD.uploadPath)},50)}}catch(ex){alert(ex.toString())}};var _getType=function(){var type;if("object"==typeof FileAction.tableListTr.cells&&FileAction.tableListTr.cells[3]){type=(FileAction.tableListTr.cells[3].innerHTML)}return type};var parseRenameJSON=function(xhr,responseText){eval(responseText);if(MESSAGE["1"]=="RENAME_RESULT=success"){DirAction.getDirJSON(decodeHTML(UPLOAD.uploadPath));if(FileAction.tableListTr.cells[3].innerHTML=="folder"){_refreshDirTree()}}else{getReNameError(MESSAGE)}};var copyFile=function(trObj){fileClass.copyFile(trObj);_hideFileEditBar()};var parseCopyJSON=function(xhr,responseText){eval(responseText);if(MESSAGE["2"]=="COPY_RESULT=success"){DirAction.getDirJSON(decodeHTML(UPLOAD.uploadPath));_refreshDirTree()}else{getCopyFileError(MESSAGE)}};var deleteFile=function(trObj){_hideFileEditBar();trObj=_getTableTrByIndex(FileAction.tableListTrIndex);if(!trObj||"object"!=typeof trObj){return}FileAction.tableListTr=trObj;fileClass.deleteFile(trObj)};var parseDeleteJSON=function(xhr,responseText){eval(responseText);if(MESSAGE){if(MESSAGE["1"]=="DELETE_RESULT=success"){if(FileAction.tableListTr.cells[3]&&FileAction.tableListTr.cells[3].innerHTML=="folder"){_refreshDirTree()}DirAction.getDirJSON(decodeHTML(UPLOAD.uploadPath))}else{getDeleteFileError(MESSAGE)}}};var createFolder=function(path,name){if(name==null||trim(name).length==""){_setTips(null,"请输入文件夹名称");return false}if(!isAvailableName(name)){_setTips(null,"名字不能含有:"+SPECIAL_CHAR.join(", ")+" 字符");return false}if(isAvailableName(name)){fileClass.getFolderJSON(path,name)}return false};var parseFolderJSON=function(xhr,responseText){eval(responseText);if(MESSAGE){if(MESSAGE["1"]=="MKDIR_RESULT=failed"){getCreateNewFolderError(MESSAGE);return}}fileClass.insertRow(FILE.newFolder);hideCreateFolder();_refreshDirTree()};var _showOrHide=function(obj){if("object"!=typeof obj){return}var isHide=((obj.style.display==""||obj.style.display=="none"));obj.style.display=isHide?"block":"none"};var _show=function(obj){if("object"!=typeof obj){return}obj.style.display="block"};var _hide=function(obj){if("object"==typeof obj){obj.style.display="none"}};var _showFileEditBar=function(){if(g("FileEditBar")){_show(g("FileEditBar"))}};var _showRenameArea=function(){if(g("FileRenameArea")){_show(g("FileRenameArea"))}isEditing=true};var _hideFileEditBar=function(){if(g("FileEditBar")){_hide(g("FileEditBar"))}};var hideRenameArea=function(){if(g("FileRenameArea")){_hideRenameArea()}};var _hideRenameArea=function(){if(g("FileRenameArea")){_hide(g("FileRenameArea"))}isEditing=false};var hideFileEditBar=function(){_hideFileEditBar()};var getReNameError=function(message){alert("重命名失败。可能没有权限或者已存在同名文件(夹)。谢谢！")};var getCopyFileError=function(message){alert("复制失败。可能没有权限或者文件(夹)不存在。谢谢！")};var getDeleteFileError=function(message){alert("删除失败。可能没有权限或者文件(夹)不存在。谢谢！")};var getCreateNewFolderError=function(message){alert("新建文件夹失败。请检查是否重名或者没有权限。谢谢！")};return{init:init,outFileListContent:outFileListContent,createFolder:createFolder,setCreateFolderHTML:setCreateFolderHTML,hideCreateFolder:hideCreateFolder,parseFolderJSON:parseFolderJSON,parseDeleteJSON:parseDeleteJSON,parseRenameJSON:parseRenameJSON,parseCopyJSON:parseCopyJSON,initTableListRowEvent:initTableListRowEvent,setTrOver:setTrOver,setTrOut:setTrOut,renameFile:renameFile,copyFile:copyFile,deleteFile:deleteFile,tableListTr:tableListTr,tableListTrIndex:tableListTrIndex,hideFileEditBar:hideFileEditBar,setRenameArea:setRenameArea,hideRenameArea:hideRenameArea,isEditing:isEditing}})();FileAction.init();function Help(){this.helpElement=this.helpElement||null}Help.prototype={setHelpHTML:function(f){try{if(!this.helpElement){var d=HTMLTemplate.helpHTML;var a=getTemplateHTMLContainer();var h=document.createElement("div");h.innerHTML=d;h.id="HelpArea";h.className="help-area";document.body.appendChild(h);this.helpElement=h;if(g("HelpContent")){g("HelpContent").innerHTML=f}}else{if(g("HelpContent")){g("HelpContent").innerHTML=f}}this.setPosition(this.helpElement,null,null)}catch(c){alert(c.toString())}},setPosition:function(h,c,k){if(!h||typeof h=="undefined"){return}var d=document.body.offsetWidth;var j=document.body.offsetHeight;var f=600;var a=400;if(!c){c=d>f?(d-f)/2:0}if(!k){k=j>a?(j-a)/2-20:0}h.style.left=c+"px";h.style.top=k+"px"},showHelpElement:function(){if(this.helpElement){this.helpElement.style.display=""}},hideHelpElement:function(){if(this.helpElement){this.helpElement.style.display="none"}}};HelpAction=(function(){var a;var f={index:""};var h=function(){a=new Help()};var c=function(){if(f.index.length<=0){var k="help/index.html";var l=ajax.get(k,d)}else{a.setHelpHTML(f.index);toggleMask();a.showHelpElement()}};var j=function(){a.hideHelpElement();toggleMask()};var d=function(l,k){f.index=k;a.setHelpHTML(k);toggleMask();a.showHelpElement()};return{pageInit:h,show:c,close:j}})();HelpAction.pageInit();